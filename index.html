<!DOCTYPE html>

<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>AXIS</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=IBM+Plex+Mono:wght@300;400;500&family=IBM+Plex+Sans+KR:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#f5f4f0;
  --ink:#0f0f0f;
  --red:#e63022;
  --muted:#999;
  --border:#d8d6d0;
  --surface:#ffffff;
  --light:#ece9e4;
}
*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent;}
body{
  font-family:'IBM Plex Sans KR',sans-serif;
  background:var(--bg);
  color:var(--ink);
  max-width:430px;
  margin:0 auto;
  min-height:100vh;
  overflow-x:hidden;
}

/* ════════════════════════
SPLASH
════════════════════════ */
#splash{
position:fixed;inset:0;
background:#0f0f0f;
z-index:9999;
display:flex;flex-direction:column;
align-items:flex-start;justify-content:center;
padding:60px 44px;
transition:opacity .6s ease;
}
#splash.out{opacity:0;pointer-events:none;}
.sp-c{position:absolute;width:18px;height:18px;border-color:#252525;border-style:solid;}
.sp-c.tl{top:36px;left:36px;border-width:1px 0 0 1px;}
.sp-c.tr{top:36px;right:36px;border-width:1px 1px 0 0;}
.sp-c.bl{bottom:36px;left:36px;border-width:0 0 1px 1px;}
.sp-c.br{bottom:36px;right:36px;border-width:0 1px 1px 0;}
.sp-loading-txt{
position:absolute;top:44px;left:50%;transform:translateX(-50%);
font-family:‘IBM Plex Mono’,monospace;font-size:8px;letter-spacing:3px;
color:#2e2e2e;text-transform:uppercase;white-space:nowrap;
}
.sp-welcome{font-family:‘IBM Plex Mono’,monospace;font-size:10px;letter-spacing:3px;color:#4a4a4a;text-transform:uppercase;margin-bottom:14px;}
.sp-axis{font-family:‘Bebas Neue’,sans-serif;font-size:108px;line-height:.84;letter-spacing:4px;color:#f0ede8;margin-bottom:28px;}
.sp-line{width:36px;height:2px;background:#e63022;margin-bottom:26px;}
.sp-slogan span{display:block;font-family:‘IBM Plex Mono’,monospace;font-size:12px;color:#f0ede8;line-height:2.3;letter-spacing:1px;}
.sp-bar-wrap{position:absolute;bottom:56px;left:44px;right:44px;}
.sp-bar-row{display:flex;justify-content:space-between;font-family:‘IBM Plex Mono’,monospace;font-size:8px;letter-spacing:2px;color:#2e2e2e;text-transform:uppercase;margin-bottom:7px;}
.sp-track{height:1px;background:#1c1c1c;overflow:hidden;}
.sp-fill{height:100%;background:#e63022;width:0%;transition:width .15s linear;}

/* ════════════════════════
LOCK
════════════════════════ */
#lock{
position:fixed;inset:0;
background:#0f0f0f;
z-index:8888;
display:flex;flex-direction:column;
align-items:center;justify-content:center;
padding:40px 28px;
}
#lock.gone{display:none;}
.lk-title{font-family:‘Bebas Neue’,sans-serif;font-size:52px;letter-spacing:2px;color:#f0ede8;line-height:.9;text-align:center;margin-bottom:6px;}
.lk-title span{color:#e63022;}
.lk-sub{font-family:‘IBM Plex Mono’,monospace;font-size:9px;letter-spacing:2px;color:#555;text-transform:uppercase;margin-bottom:48px;}
.lk-dots{display:flex;gap:14px;margin-bottom:36px;}
.lk-dot{width:13px;height:13px;border-radius:50%;border:2px solid #333;transition:all .15s;}
.lk-dot.on{background:#f0ede8;border-color:#f0ede8;}
.lk-dot.err{background:#e63022;border-color:#e63022;}
.lk-err{font-family:‘IBM Plex Mono’,monospace;font-size:9px;letter-spacing:2px;color:#e63022;text-transform:uppercase;height:14px;margin-bottom:28px;text-align:center;}
.keypad{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;width:100%;max-width:270px;}
.k{aspect-ratio:1;background:#1a1a1a;border:none;border-radius:50%;color:#f0ede8;font-family:‘Bebas Neue’,sans-serif;font-size:26px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .1s;}
.k:active{background:#2e2e2e;transform:scale(.93);}
.k.del{font-family:‘IBM Plex Mono’,monospace;font-size:14px;color:#555;}
.k.emp{background:transparent;pointer-events:none;}

/* ════════════════════════
APP WRAPPER
════════════════════════ */
#app{padding-bottom:68px;}

/* ════════════════════════
HEADER BLOCK
════════════════════════ */
.hdr-block{display:flex;border-bottom:2px solid var(–ink);}
.hdr-main{flex:1;padding:44px 22px 18px;overflow:hidden;}
.hdr-eye1{font-family:‘IBM Plex Mono’,monospace;font-size:8px;letter-spacing:2px;color:var(–muted);text-transform:uppercase;margin-bottom:2px;}
.hdr-eye2{font-family:‘IBM Plex Mono’,monospace;font-size:8px;letter-spacing:2px;color:var(–muted);text-transform:uppercase;margin-bottom:8px;}
.hdr-title{font-family:‘Bebas Neue’,sans-serif;font-size:62px;line-height:.88;letter-spacing:2px;color:var(–ink);}
.hdr-title span{color:var(–red);}
.hdr-quote{font-family:‘IBM Plex Mono’,monospace;font-size:10px;color:var(–muted);margin-top:14px;padding-left:10px;border-left:2px solid var(–red);line-height:1.65;}

/* ════════════════════════
SIDEBAR (header only)
════════════════════════ */
.hdr-sidebar{
width:46px;flex-shrink:0;
background:#0f0f0f;
display:flex;flex-direction:column;
align-items:center;justify-content:center;
gap:0;
}
.sb-tab{
writing-mode:vertical-rl;
transform:rotate(180deg);
font-family:‘IBM Plex Mono’,monospace;
font-size:8px;letter-spacing:2px;text-transform:uppercase;
color:#444;
padding:16px 6px;
cursor:pointer;
border-left:2px solid transparent;
width:100%;text-align:center;
transition:all .15s;
flex:1;display:flex;align-items:center;justify-content:center;
}
.sb-tab.on{color:#f0ede8;border-left:2px solid #e63022;}
.sb-div{width:20px;height:1px;background:#222;}

/* ════════════════════════
DATE NAV
════════════════════════ */
.date-nav{
display:flex;align-items:center;justify-content:space-between;
padding:9px 22px;border-bottom:1px solid var(–border);
}
.dn-btn{
width:26px;height:26px;background:transparent;
border:1.5px solid var(–border);color:var(–ink);
font-size:15px;cursor:pointer;
display:flex;align-items:center;justify-content:center;
}
.dn-btn:disabled{opacity:.25;cursor:default;}
.dn-lbl{font-family:‘IBM Plex Mono’,monospace;font-size:10px;letter-spacing:1px;}
.dn-lbl.today{color:var(–red);}

/* ════════════════════════
PROGRESS
════════════════════════ */
.prog-wrap{padding:18px 22px 14px;border-bottom:1px solid var(–border);}
.prog-top{display:flex;align-items:flex-end;justify-content:space-between;margin-bottom:9px;}
.prog-pct{font-family:‘Bebas Neue’,sans-serif;font-size:50px;line-height:1;}
.prog-msg{font-family:‘IBM Plex Mono’,monospace;font-size:9px;color:var(–muted);text-align:right;line-height:1.5;max-width:170px;}
.prog-track{height:2px;background:var(–border);position:relative;}
.prog-fill{position:absolute;left:0;top:0;height:100%;background:var(–ink);transition:width .5s;}
.prog-bot{display:flex;justify-content:space-between;margin-top:5px;}
.prog-lbl{font-family:‘IBM Plex Mono’,monospace;font-size:8px;letter-spacing:1.5px;color:var(–muted);text-transform:uppercase;}

/* ════════════════════════
TAB NAV
════════════════════════ */
.tab-nav{display:flex;border-bottom:2px solid var(–ink);}
.tb{
flex:1;padding:11px 6px;border:none;border-right:1px solid var(–border);
background:transparent;color:var(–muted);
font-family:‘IBM Plex Mono’,monospace;font-size:9px;letter-spacing:2px;text-transform:uppercase;
cursor:pointer;transition:all .15s;
}
.tb:last-child{border-right:none;}
.tb.on{background:var(–ink);color:var(–bg);}

.view{display:none;}
.view.on{display:block;}

/* ════════════════════════
CATEGORIES & ITEMS
════════════════════════ */
.cat-block{border-bottom:1px solid var(–border);}
.cat-hdr{padding:11px 22px 4px;}
.cat-name{font-family:‘IBM Plex Mono’,monospace;font-size:8px;letter-spacing:3px;text-transform:uppercase;color:var(–muted);}
.row{
display:flex;align-items:center;
padding:11px 22px;border-top:1px solid var(–border);
cursor:pointer;user-select:none;gap:11px;
transition:background .1s;
}
.row:active{background:var(–light);}
.row.done{background:var(–light);}
.row-num{font-family:‘IBM Plex Mono’,monospace;font-size:9px;color:var(–border);width:18px;flex-shrink:0;}
.row.done .row-num{color:var(–red);}
.row-name{flex:1;font-size:14px;}
.row.done .row-name{text-decoration:line-through;color:var(–muted);}
.row-sub{font-family:‘IBM Plex Mono’,monospace;font-size:9px;color:var(–muted);white-space:nowrap;}
.row-box{
width:17px;height:17px;border:1.5px solid var(–border);
display:flex;align-items:center;justify-content:center;
flex-shrink:0;font-size:9px;font-family:‘IBM Plex Mono’,monospace;
}
.row.done .row-box{background:var(–ink);border-color:var(–ink);color:var(–bg);}
.add-row{
display:flex;align-items:center;
padding:10px 22px;border-top:1px solid var(–border);
cursor:pointer;gap:11px;
}
.add-row:active{background:var(–light);}
.add-icon{
width:17px;height:17px;border:1.5px dashed var(–border);
display:flex;align-items:center;justify-content:center;
font-size:13px;color:var(–border);flex-shrink:0;
}
.add-txt{font-family:‘IBM Plex Mono’,monospace;font-size:9px;letter-spacing:1px;text-transform:uppercase;color:var(–muted);}

/* ════════════════════════
STATS / CALENDAR
════════════════════════ */
.mo-nav{display:flex;align-items:center;justify-content:space-between;padding:14px 22px;border-bottom:1px solid var(–border);}
.mo-lbl{font-family:‘Bebas Neue’,sans-serif;font-size:26px;letter-spacing:1px;}
.mo-btn{width:30px;height:30px;background:transparent;border:1.5px solid var(–border);color:var(–ink);font-size:15px;cursor:pointer;display:flex;align-items:center;justify-content:center;}
.mo-btn:active{background:var(–ink);color:var(–bg);}
.cal-wrap{padding:14px 22px;border-bottom:1px solid var(–border);}
.cal-days{display:grid;grid-template-columns:repeat(7,1fr);margin-bottom:4px;}
.cal-dlbl{text-align:center;font-family:‘IBM Plex Mono’,monospace;font-size:8px;color:var(–muted);padding:3px 0;}
.cal-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:2px;}
.cc{aspect-ratio:1;display:flex;align-items:center;justify-content:center;font-family:‘IBM Plex Mono’,monospace;font-size:10px;border-radius:2px;cursor:pointer;}
.cc.today{border:1.5px solid var(–red);color:var(–red);font-weight:500;}
.cc.p0{color:var(–border);}
.cc.p10{background:#e6e6e6;color:#888;}
.cc.p30{background:#f4a261;color:#fff;}
.cc.p50{background:#e76f51;color:#fff;}
.cc.p70{background:#52b788;color:#fff;}
.cc.p90{background:#2d6a4f;color:#fff;}
.cc.p100{background:#0f0f0f;color:#f0ede8;}
.cc.fut{color:var(–border);opacity:.4;cursor:default;}
.cc.trained{background:#0f0f0f;color:#f0ede8;}
.stat-row{display:flex;align-items:baseline;justify-content:space-between;padding:13px 22px;border-bottom:1px solid var(–border);}
.stat-lbl{font-family:‘IBM Plex Mono’,monospace;font-size:9px;letter-spacing:1px;text-transform:uppercase;color:var(–muted);}
.stat-val{font-family:‘Bebas Neue’,sans-serif;font-size:30px;letter-spacing:1px;}
.stat-val small{font-family:‘IBM Plex Mono’,monospace;font-size:11px;color:var(–muted);}
.bar-sec{padding:14px 22px;}
.bar-sec-lbl{font-family:‘IBM Plex Mono’,monospace;font-size:8px;letter-spacing:2px;text-transform:uppercase;color:var(–muted);margin-bottom:12px;}
.bar-row{display:flex;align-items:center;gap:9px;margin-bottom:9px;}
.bar-nm{font-family:‘IBM Plex Mono’,monospace;font-size:9px;width:76px;flex-shrink:0;color:var(–muted);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
.bar-track{flex:1;height:2px;background:var(–border);position:relative;}
.bar-fill{position:absolute;left:0;top:0;height:100%;background:var(–ink);}
.bar-pct{font-family:‘IBM Plex Mono’,monospace;font-size:9px;color:var(–muted);width:30px;text-align:right;flex-shrink:0;}

/* ════════════════════════
WORKOUT LOG
════════════════════════ */
.wlog{padding:16px 22px;border-bottom:1px solid var(–border);}
.wlog-title{font-family:‘IBM Plex Mono’,monospace;font-size:8px;letter-spacing:3px;text-transform:uppercase;color:var(–muted);margin-bottom:14px;}
.wf{margin-bottom:13px;}
.wf-lbl{font-family:‘IBM Plex Mono’,monospace;font-size:8px;letter-spacing:2px;text-transform:uppercase;color:var(–muted);margin-bottom:6px;}
.chips{display:flex;flex-wrap:wrap;gap:5px;}
.chip{
font-family:‘IBM Plex Mono’,monospace;font-size:10px;
padding:5px 11px;border:1.5px solid var(–border);
cursor:pointer;transition:all .15s;color:var(–muted);
}
.chip.on{background:var(–ink);border-color:var(–ink);color:var(–bg);}
.wlog-input{
width:100%;background:var(–surface);border:1px solid var(–border);
color:var(–ink);font-family:‘IBM Plex Mono’,monospace;font-size:12px;
padding:10px 12px;outline:none;
}
.wlog-input:focus{border-color:var(–ink);}
.rate-row{display:flex;gap:5px;}
.rate-btn{
flex:1;padding:8px 4px;background:transparent;
border:1.5px solid var(–border);
font-family:‘IBM Plex Mono’,monospace;font-size:11px;
cursor:pointer;color:var(–muted);text-align:center;
}
.rate-btn.on{background:var(–ink);border-color:var(–ink);color:var(–bg);}
.cond-row{display:flex;gap:5px;}
.cond-btn{
flex:1;padding:7px 2px;background:transparent;
border:1.5px solid var(–border);
font-family:‘IBM Plex Mono’,monospace;font-size:7px;letter-spacing:.5px;
cursor:pointer;color:var(–muted);text-align:center;text-transform:uppercase;
}
.cond-btn.on{background:var(–ink);border-color:var(–ink);color:var(–bg);}
.wlog-save{
width:100%;padding:12px;background:var(–ink);color:var(–bg);
border:none;font-family:‘IBM Plex Mono’,monospace;
font-size:9px;letter-spacing:2px;text-transform:uppercase;
cursor:pointer;margin-top:4px;
}
.wlog-save:active{background:var(–red);}

/* ════════════════════════
SETTINGS
════════════════════════ */
.set-grp{border-bottom:1px solid var(–border);}
.set-grp-lbl{padding:13px 22px 5px;font-family:‘IBM Plex Mono’,monospace;font-size:8px;letter-spacing:3px;text-transform:uppercase;color:var(–muted);}
.set-row{
display:flex;align-items:center;justify-content:space-between;
padding:13px 22px;border-top:1px solid var(–border);cursor:pointer;transition:background .1s;
}
.set-row:active{background:var(–light);}
.set-row-name{font-size:14px;font-weight:400;}
.set-row-desc{font-family:‘IBM Plex Mono’,monospace;font-size:9px;color:var(–muted);margin-top:2px;}
.set-row-arrow{font-family:‘IBM Plex Mono’,monospace;font-size:13px;color:var(–border);}
.set-row.danger .set-row-name{color:var(–red);}

/* ════════════════════════
MODALS
════════════════════════ */
.ov{
position:fixed;inset:0;background:rgba(0,0,0,.55);
z-index:500;display:flex;align-items:flex-end;justify-content:center;
opacity:0;pointer-events:none;transition:opacity .2s;
}
.ov.show{opacity:1;pointer-events:all;}
.modal{
background:var(–bg);border-top:2px solid var(–ink);
padding:22px;width:100%;max-width:430px;
transform:translateY(16px);transition:transform .25s;
max-height:82vh;overflow-y:auto;
}
.ov.show .modal{transform:translateY(0);}
.m-title{font-family:‘Bebas Neue’,sans-serif;font-size:30px;letter-spacing:1px;margin-bottom:5px;}
.m-desc{font-family:‘IBM Plex Mono’,monospace;font-size:10px;color:var(–muted);margin-bottom:18px;line-height:1.6;}
.m-textarea{
width:100%;height:100px;background:var(–surface);
border:1px solid var(–border);color:var(–ink);
font-family:‘IBM Plex Mono’,monospace;font-size:10px;
padding:11px;resize:none;outline:none;margin-bottom:11px;
}
.m-input{
width:100%;background:var(–surface);border:1px solid var(–border);
color:var(–ink);font-family:‘IBM Plex Mono’,monospace;font-size:12px;
padding:11px;outline:none;margin-bottom:9px;
}
.m-input:focus{border-color:var(–ink);}
.m-lbl{font-family:‘IBM Plex Mono’,monospace;font-size:8px;letter-spacing:2px;text-transform:uppercase;color:var(–muted);margin-bottom:5px;margin-top:3px;display:block;}
.m-sel{
width:100%;background:var(–surface);border:1px solid var(–border);
color:var(–ink);font-family:‘IBM Plex Mono’,monospace;font-size:12px;
padding:11px;outline:none;margin-bottom:9px;appearance:none;
}
.btn-row{display:flex;gap:7px;margin-top:4px;}
.btn{flex:1;padding:12px;border:none;font-family:‘IBM Plex Mono’,monospace;font-size:9px;letter-spacing:2px;text-transform:uppercase;cursor:pointer;}
.btn-p{background:var(–ink);color:var(–bg);}
.btn-p:active{background:var(–red);}
.btn-s{background:transparent;color:var(–ink);border:1.5px solid var(–border);}

/* DELETE LIST */
.dl-row{display:flex;align-items:center;justify-content:space-between;padding:11px 0;border-bottom:1px solid var(–border);}
.dl-name{font-size:13px;}
.dl-sub{font-family:‘IBM Plex Mono’,monospace;font-size:9px;color:var(–muted);}
.dl-del{background:none;border:1.5px solid var(–border);color:var(–red);font-family:‘IBM Plex Mono’,monospace;font-size:9px;padding:5px 11px;cursor:pointer;letter-spacing:1px;white-space:nowrap;}
.dl-del:active{background:var(–red);color:var(–bg);border-color:var(–red);}
.sec-title{font-family:‘Bebas Neue’,sans-serif;font-size:20px;letter-spacing:1px;margin:16px 0 8px;}

/* ════════════════════════
BOTTOM BAR
════════════════════════ */
.bottom{
position:fixed;bottom:0;left:50%;transform:translateX(-50%);
width:100%;max-width:430px;
background:var(–ink);color:var(–bg);
padding:13px 22px;
display:flex;justify-content:space-between;align-items:center;
z-index:100;
}
.bot-msg{font-family:‘IBM Plex Mono’,monospace;font-size:9px;letter-spacing:1.5px;text-transform:uppercase;}
.bot-cnt{font-family:‘Bebas Neue’,sans-serif;font-size:22px;letter-spacing:1px;color:var(–red);}

/* TOAST */
.toast{
position:fixed;bottom:66px;left:50%;transform:translateX(-50%);
background:var(–ink);color:var(–bg);
font-family:‘IBM Plex Mono’,monospace;font-size:9px;letter-spacing:1.5px;text-transform:uppercase;
padding:9px 18px;opacity:0;transition:opacity .25s;pointer-events:none;white-space:nowrap;z-index:600;
}
.toast.show{opacity:1;}
.toast.err{background:var(–red);}
</style>

</head>
<body>

<!-- ── SPLASH ── -->

<div id="splash">
  <div class="sp-c tl"></div><div class="sp-c tr"></div>
  <div class="sp-c bl"></div><div class="sp-c br"></div>
  <div class="sp-loading-txt">Loading your data...</div>
  <div class="sp-welcome">Welcome to</div>
  <div class="sp-axis">AXIS</div>
  <div class="sp-line"></div>
  <div class="sp-slogan">
    <span>Breathe.</span><span>Align.</span><span>Repeat.</span>
  </div>
  <div class="sp-bar-wrap">
    <div class="sp-bar-row"><span>Initializing</span><span id="spPct">0%</span></div>
    <div class="sp-track"><div class="sp-fill" id="spFill"></div></div>
  </div>
</div>

<!-- ── LOCK ── -->

<div id="lock">
  <div class="lk-title">DAILY<br><span>ROUTINE</span></div>
  <div class="lk-sub">Enter passcode</div>
  <div class="lk-dots">
    <div class="lk-dot" id="d0"></div><div class="lk-dot" id="d1"></div>
    <div class="lk-dot" id="d2"></div><div class="lk-dot" id="d3"></div>
  </div>
  <div class="lk-err" id="lkErr"></div>
  <div class="keypad">
    <button class="k" onclick="kp('1')">1</button><button class="k" onclick="kp('2')">2</button><button class="k" onclick="kp('3')">3</button>
    <button class="k" onclick="kp('4')">4</button><button class="k" onclick="kp('5')">5</button><button class="k" onclick="kp('6')">6</button>
    <button class="k" onclick="kp('7')">7</button><button class="k" onclick="kp('8')">8</button><button class="k" onclick="kp('9')">9</button>
    <button class="k emp"></button><button class="k" onclick="kp('0')">0</button><button class="k del" onclick="kd()">DEL</button>
  </div>
</div>

<!-- ── APP ── -->

<div id="app">

  <!-- DAILY PAGE -->

  <div id="pg-daily">
    <div class="hdr-block">
      <div class="hdr-main">
        <div class="hdr-eye1">Find Your Balance with "AXIS"</div>
        <div class="hdr-eye2" id="hDate"></div>
        <div class="hdr-title">DAILY<br><span>ROUTINE</span></div>
        <div class="hdr-quote">Rejection is redirection.<br>A promise to yourself.</div>
      </div>
      <div class="hdr-sidebar">
        <div class="sb-tab on" onclick="gotoPage('daily')">Daily</div>
        <div class="sb-div"></div>
        <div class="sb-tab" onclick="gotoPage('workout')">Workout</div>
      </div>
    </div>
    <div class="date-nav">
      <button class="dn-btn" id="dPrev" onclick="chDay(-1)">&#8249;</button>
      <div class="dn-lbl today" id="dLbl">Today</div>
      <button class="dn-btn" id="dNext" onclick="chDay(1)" disabled>&#8250;</button>
    </div>
    <div class="prog-wrap">
      <div class="prog-top">
        <div class="prog-pct" id="dPct">0%</div>
        <div class="prog-msg" id="dMsg">Start your day.</div>
      </div>
      <div class="prog-track"><div class="prog-fill" id="dFill"></div></div>
      <div class="prog-bot">
        <span class="prog-lbl">Progress</span>
        <span class="prog-lbl" id="dCnt">0 / 0</span>
      </div>
    </div>
    <div class="tab-nav">
      <button class="tb on" onclick="dTab('today',this)">Today</button>
      <button class="tb" onclick="dTab('stats',this)">Stats</button>
      <button class="tb" onclick="dTab('settings',this)">Settings</button>
    </div>
    <!-- TODAY -->
    <div class="view on" id="vd-today">
      <div id="rList"></div>
      <div class="add-row" onclick="openAddR()">
        <div class="add-icon">+</div><div class="add-txt">Add item</div>
      </div>
    </div>
    <!-- STATS -->
    <div class="view" id="vd-stats">
      <div class="mo-nav">
        <button class="mo-btn" onclick="chMo(-1)">&#8249;</button>
        <div class="mo-lbl" id="dMoLbl"></div>
        <button class="mo-btn" onclick="chMo(1)">&#8250;</button>
      </div>
      <div class="cal-wrap">
        <div class="cal-days">
          <div class="cal-dlbl">SUN</div><div class="cal-dlbl">MON</div><div class="cal-dlbl">TUE</div>
          <div class="cal-dlbl">WED</div><div class="cal-dlbl">THU</div><div class="cal-dlbl">FRI</div><div class="cal-dlbl">SAT</div>
        </div>
        <div class="cal-grid" id="dCalGrid"></div>
      </div>
      <div id="dStatRows"></div>
      <div class="bar-sec"><div class="bar-sec-lbl">Per Item Rate</div><div id="dBarRows"></div></div>
    </div>
    <!-- SETTINGS -->
    <div class="view" id="vd-settings">
      <div class="set-grp">
        <div class="set-grp-lbl">Backup</div>
        <div class="set-row" onclick="doExport()"><div><div class="set-row-name">데이터 내보내기</div><div class="set-row-desc">전체 데이터 복사 보관</div></div><div class="set-row-arrow">→</div></div>
        <div class="set-row" onclick="openImport()"><div><div class="set-row-name">데이터 가져오기</div><div class="set-row-desc">복사해둔 코드 붙여넣기</div></div><div class="set-row-arrow">→</div></div>
      </div>
      <div class="set-grp">
        <div class="set-grp-lbl">Manage</div>
        <div class="set-row" onclick="openManageR()"><div><div class="set-row-name">루틴 관리</div><div class="set-row-desc">항목 삭제 및 카테고리 수정</div></div><div class="set-row-arrow">→</div></div>
      </div>
      <div class="set-grp">
        <div class="set-grp-lbl">Danger</div>
        <div class="set-row danger" onclick="resetD()"><div><div class="set-row-name">전체 초기화</div><div class="set-row-desc">모든 기록 삭제</div></div><div class="set-row-arrow">→</div></div>
      </div>
    </div>
  </div>

  <!-- WORKOUT PAGE -->

  <div id="pg-workout" style="display:none;">
    <div class="hdr-block">
      <div class="hdr-main">
        <div class="hdr-eye1">Find Your Balance with "AXIS"</div>
        <div class="hdr-eye2" id="hDateW"></div>
        <div class="hdr-title">WORK<br><span>OUT</span></div>
        <div class="hdr-quote">Train hard. Track everything.<br>Show up every day.</div>
      </div>
      <div class="hdr-sidebar">
        <div class="sb-tab" onclick="gotoPage('daily')">Daily</div>
        <div class="sb-div"></div>
        <div class="sb-tab on" onclick="gotoPage('workout')">Workout</div>
      </div>
    </div>
    <div class="prog-wrap">
      <div class="prog-top">
        <div class="prog-pct" id="wPct">0%</div>
        <div class="prog-msg" id="wMsg">Start training.</div>
      </div>
      <div class="prog-track"><div class="prog-fill" id="wFill"></div></div>
      <div class="prog-bot">
        <span class="prog-lbl">Progress</span>
        <span class="prog-lbl" id="wCnt">0 / 0</span>
      </div>
    </div>
    <div class="tab-nav">
      <button class="tb on" onclick="wTab('today',this)">Today</button>
      <button class="tb" onclick="wTab('cal',this)">Calendar</button>
      <button class="tb" onclick="wTab('settings',this)">Settings</button>
    </div>
    <!-- TODAY -->
    <div class="view on" id="vw-today">
      <div id="wList"></div>
      <div class="add-row" onclick="openAddW()">
        <div class="add-icon">+</div><div class="add-txt">Add exercise</div>
      </div>
    </div>
    <!-- CALENDAR -->
    <div class="view" id="vw-cal">
      <div class="mo-nav">
        <button class="mo-btn" onclick="chWMo(-1)">&#8249;</button>
        <div class="mo-lbl" id="wMoLbl"></div>
        <button class="mo-btn" onclick="chWMo(1)">&#8250;</button>
      </div>
      <div class="cal-wrap">
        <div class="cal-days">
          <div class="cal-dlbl">SUN</div><div class="cal-dlbl">MON</div><div class="cal-dlbl">TUE</div>
          <div class="cal-dlbl">WED</div><div class="cal-dlbl">THU</div><div class="cal-dlbl">FRI</div><div class="cal-dlbl">SAT</div>
        </div>
        <div class="cal-grid" id="wCalGrid"></div>
      </div>
      <div class="wlog">
        <div class="wlog-title" id="wlogTitle">Today's Log</div>
        <div class="wf">
          <div class="wf-lbl">Target 부위</div>
          <div class="chips" id="chipWrap">
            <div class="chip" data-v="가슴" onclick="togChip(this)">가슴</div>
            <div class="chip" data-v="어깨" onclick="togChip(this)">어깨</div>
            <div class="chip" data-v="등" onclick="togChip(this)">등</div>
            <div class="chip" data-v="이두" onclick="togChip(this)">이두</div>
            <div class="chip" data-v="삼두" onclick="togChip(this)">삼두</div>
            <div class="chip" data-v="복부" onclick="togChip(this)">복부</div>
            <div class="chip" data-v="하체" onclick="togChip(this)">하체</div>
          </div>
        </div>
        <div class="wf">
          <div class="wf-lbl">총 운동 시간</div>
          <input class="wlog-input" id="wlogTime" type="number" placeholder="분 (e.g. 60)">
        </div>
        <div class="wf">
          <div class="wf-lbl">만족도</div>
          <div class="rate-row">
            <button class="rate-btn" data-v="1" onclick="selRate(this)">1</button>
            <button class="rate-btn" data-v="2" onclick="selRate(this)">2</button>
            <button class="rate-btn" data-v="3" onclick="selRate(this)">3</button>
            <button class="rate-btn" data-v="4" onclick="selRate(this)">4</button>
            <button class="rate-btn" data-v="5" onclick="selRate(this)">5</button>
          </div>
        </div>
        <div class="wf">
          <div class="wf-lbl">컨디션</div>
          <div class="cond-row">
            <button class="cond-btn" data-v="매우좋음" onclick="selCond(this)">매우좋음</button>
            <button class="cond-btn" data-v="좋음" onclick="selCond(this)">좋음</button>
            <button class="cond-btn" data-v="보통" onclick="selCond(this)">보통</button>
            <button class="cond-btn" data-v="나쁨" onclick="selCond(this)">나쁨</button>
          </div>
        </div>
        <div class="wf">
          <div class="wf-lbl">메모</div>
          <input class="wlog-input" id="wlogMemo" placeholder="한 줄 메모...">
        </div>
        <button class="wlog-save" onclick="saveLog()">Save Log</button>
      </div>
      <div id="wStatRows"></div>
    </div>
    <!-- SETTINGS -->
    <div class="view" id="vw-settings">
      <div class="set-grp">
        <div class="set-grp-lbl">Backup</div>
        <div class="set-row" onclick="doExport()"><div><div class="set-row-name">데이터 내보내기</div><div class="set-row-desc">전체 데이터 복사 보관</div></div><div class="set-row-arrow">→</div></div>
        <div class="set-row" onclick="openImport()"><div><div class="set-row-name">데이터 가져오기</div><div class="set-row-desc">복사해둔 코드 붙여넣기</div></div><div class="set-row-arrow">→</div></div>
      </div>
      <div class="set-grp">
        <div class="set-grp-lbl">Manage</div>
        <div class="set-row" onclick="openManageW()"><div><div class="set-row-name">운동 관리</div><div class="set-row-desc">항목 삭제 및 카테고리 수정</div></div><div class="set-row-arrow">→</div></div>
      </div>
      <div class="set-grp">
        <div class="set-grp-lbl">Danger</div>
        <div class="set-row danger" onclick="resetW()"><div><div class="set-row-name">운동 기록 초기화</div><div class="set-row-desc">모든 운동 기록 삭제</div></div><div class="set-row-arrow">→</div></div>
      </div>
    </div>
  </div>

</div><!-- /app -->

<!-- MODALS -->

<div class="ov" id="ov-export"><div class="modal">
  <div class="m-title">Export</div>
  <div class="m-desc">아래 코드를 전체 복사해서 저장하세요.</div>
  <textarea class="m-textarea" id="expTxt" readonly></textarea>
  <div class="btn-row"><button class="btn btn-s" onclick="closeOv('ov-export')">Close</button><button class="btn btn-p" onclick="copyExp()">Copy</button></div>
</div></div>

<div class="ov" id="ov-import"><div class="modal">
  <div class="m-title">Import</div>
  <div class="m-desc">복사해둔 코드를 아래에 붙여넣으세요.</div>
  <textarea class="m-textarea" id="impTxt" placeholder="Paste here..."></textarea>
  <div class="btn-row"><button class="btn btn-s" onclick="closeOv('ov-import')">Cancel</button><button class="btn btn-p" onclick="doImport()">Import</button></div>
</div></div>

<div class="ov" id="ov-addR"><div class="modal">
  <div class="m-title">Add Item</div>
  <label class="m-lbl">카테고리</label>
  <select class="m-sel" id="rCatSel"></select>
  <input class="m-input" id="rName" placeholder="Item name (e.g. 런닝)">
  <input class="m-input" id="rSub" placeholder="Sub label (e.g. 5 KM) — optional">
  <div class="btn-row"><button class="btn btn-s" onclick="closeOv('ov-addR')">Cancel</button><button class="btn btn-p" onclick="doAddR()">Add</button></div>
</div></div>

<div class="ov" id="ov-addW"><div class="modal">
  <div class="m-title">Add Exercise</div>
  <label class="m-lbl">카테고리</label>
  <select class="m-sel" id="wCatSel"></select>
  <input class="m-input" id="wName" placeholder="운동 이름 (e.g. 벤치프레스)">
  <input class="m-input" id="wWeight" placeholder="무게 (e.g. 80kg)">
  <input class="m-input" id="wReps" placeholder="횟수 (e.g. 10)" type="number" min="1">
  <input class="m-input" id="wSets" placeholder="세트수 (e.g. 5)" type="number" min="1">
  <div class="btn-row"><button class="btn btn-s" onclick="closeOv('ov-addW')">Cancel</button><button class="btn btn-p" onclick="doAddW()">Add</button></div>
</div></div>

<div class="ov" id="ov-manR"><div class="modal">
  <div class="m-title">루틴 관리</div>
  <div id="manRList"></div>
  <div class="sec-title">카테고리 관리</div>
  <div id="manRCat"></div>
  <div style="display:flex;gap:7px;margin-top:9px;">
    <input class="m-input" id="newRCat" placeholder="새 카테고리" style="margin-bottom:0;flex:1;">
    <button class="btn btn-p" style="flex:0 0 auto;padding:11px 14px;" onclick="addRCat()">+</button>
  </div>
  <div class="btn-row" style="margin-top:14px;"><button class="btn btn-s" onclick="closeOv('ov-manR')">Close</button></div>
</div></div>

<div class="ov" id="ov-manW"><div class="modal">
  <div class="m-title">운동 관리</div>
  <div id="manWList"></div>
  <div class="sec-title">카테고리 관리</div>
  <div id="manWCat"></div>
  <div style="display:flex;gap:7px;margin-top:9px;">
    <input class="m-input" id="newWCat" placeholder="새 카테고리" style="margin-bottom:0;flex:1;">
    <button class="btn btn-p" style="flex:0 0 auto;padding:11px 14px;" onclick="addWCat()">+</button>
  </div>
  <div class="btn-row" style="margin-top:14px;"><button class="btn btn-s" onclick="closeOv('ov-manW')">Close</button></div>
</div></div>

<div class="bottom">
  <div class="bot-msg" id="botMsg">Start your day</div>
  <div class="bot-cnt" id="botCnt">0/0</div>
</div>
<div class="toast" id="toast"></div>

<script>
const PC='4320';let pin='';

/* ── SPLASH ── */
function splash(cb){
  const f=document.getElementById('spFill'),p=document.getElementById('spPct');
  let v=0;
  const iv=setInterval(()=>{
    v+=Math.random()*16+5;
    if(v>=100){v=100;f.style.width='100%';p.textContent='100%';clearInterval(iv);
      setTimeout(()=>{document.getElementById('splash').classList.add('out');setTimeout(cb,700);},350);}
    else{f.style.width=v+'%';p.textContent=Math.round(v)+'%';}
  },140);
}

/* ── LOCK ── */
function kp(n){if(pin.length>=4)return;pin+=n;updDots();
  if(pin.length===4){setTimeout(()=>{
    if(pin===PC){document.getElementById('lock').classList.add('gone');sessionStorage.setItem('ok','1');init();}
    else{document.querySelectorAll('.lk-dot').forEach(d=>d.classList.add('err'));
      document.getElementById('lkErr').textContent='Incorrect passcode';
      setTimeout(()=>{pin='';updDots();document.querySelectorAll('.lk-dot').forEach(d=>d.classList.remove('on','err'));document.getElementById('lkErr').textContent='';},800);}
  },120);}
}
function kd(){pin=pin.slice(0,-1);updDots();}
function updDots(){for(let i=0;i<4;i++)document.getElementById('d'+i).classList.toggle('on',i<pin.length);}

/* ── STORAGE ── */
function gl(k,d){try{const v=localStorage.getItem(k);return v?JSON.parse(v):d;}catch{return d;}}
function sl(k,v){localStorage.setItem(k,JSON.stringify(v));}

/* ── STATE ── */
let ddata=gl('ax_d',{});
let wdata=gl('ax_w',{});
let wlog=gl('ax_wl',{});
let rcats=gl('ax_rc',[{id:'rc0',name:'Training'},{id:'rc1',name:'Nutrition'},{id:'rc2',name:'Recovery'},{id:'rc3',name:'Mind'}]);
let routines=gl('ax_r',[
  {id:'r1',name:'웨이트 트레이닝',sub:'60 MIN',cat:'rc0'},
  {id:'r2',name:'런닝',sub:'5 KM',cat:'rc0'},
  {id:'r3',name:'프로틴',sub:'48G+',cat:'rc1'},
  {id:'r4',name:'크레아틴',sub:'5G',cat:'rc1'},
  {id:'r5',name:'종합비타민',sub:'1 TAB',cat:'rc1'},
  {id:'r6',name:'수면',sub:'8 HRS',cat:'rc2'},
  {id:'r7',name:'일기 쓰기',sub:'',cat:'rc3'},
  {id:'r8',name:'글쓰기',sub:'',cat:'rc3'},
  {id:'r9',name:'독서',sub:'',cat:'rc3'},
]);
let wcats=gl('ax_wc',[{id:'wc0',name:'Chest'},{id:'wc1',name:'Back'},{id:'wc2',name:'Shoulder'},{id:'wc3',name:'Arms'},{id:'wc4',name:'Legs'},{id:'wc5',name:'Core'}]);
let workouts=gl('ax_wo',[]);

const NOW=new Date();
let dayOff=0,sY=NOW.getFullYear(),sM=NOW.getMonth(),wY=NOW.getFullYear(),wM=NOW.getMonth();
let logKey=fmt(NOW);

function fmt(d){return`${d.getFullYear()}-${p2(d.getMonth()+1)}-${p2(d.getDate())}`}
function p2(n){return String(n).padStart(2,'0')}
function disp(d){const dn=['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];return`${d.getFullYear()}.${p2(d.getMonth()+1)}.${p2(d.getDate())} ${dn[d.getDay()]}`}
function vd(){const d=new Date(NOW);d.setDate(d.getDate()+dayOff);return d;}
function vk(){return fmt(vd());}

/* ── INIT ── */
function init(){updHdrs();renderR();renderW();updBot();}

function updHdrs(){
  const d=vd();
  document.getElementById('hDate').textContent=disp(d);
  document.getElementById('hDateW').textContent=disp(d);
  const lb=document.getElementById('dLbl');
  lb.textContent=dayOff===0?'Today':dayOff===-1?'Yesterday':'2 Days Ago';
  lb.className='dn-lbl'+(dayOff===0?' today':'');
  document.getElementById('dPrev').disabled=dayOff<=-2;
  document.getElementById('dNext').disabled=dayOff>=0;
}
function chDay(n){dayOff=Math.max(-2,Math.min(0,dayOff+n));updHdrs();renderR();renderW();updBot();}

/* ── ROUTINES ── */
function getRec(){const k=vk();if(!ddata[k])ddata[k]={};return ddata[k];}
function renderR(){
  const rec=getRec();let done=0;
  const el=document.getElementById('rList');el.innerHTML='';
  rcats.forEach(cat=>{
    const items=routines.filter(r=>r.cat===cat.id);
    if(!items.length)return;
    const blk=document.createElement('div');blk.className='cat-block';
    blk.innerHTML=`<div class="cat-hdr"><div class="cat-name">${cat.name}</div></div>`;
    items.forEach((r,i)=>{
      const gi=routines.indexOf(r);
      const chk=!!rec[r.id];if(chk)done++;
      const d=document.createElement('div');
      d.className='row'+(chk?' done':'');
      d.innerHTML=`<div class="row-num">${p2(gi+1)}</div><div class="row-name">${r.name}</div>${r.sub?`<div class="row-sub">${r.sub}</div>`:''}<div class="row-box">${chk?'X':''}</div>`;
      d.onclick=()=>togR(r.id);blk.appendChild(d);
    });
    el.appendChild(blk);
  });
  const uncat=routines.filter(r=>!rcats.find(c=>c.id===r.cat));
  if(uncat.length){
    const blk=document.createElement('div');blk.className='cat-block';
    blk.innerHTML=`<div class="cat-hdr"><div class="cat-name">Other</div></div>`;
    uncat.forEach(r=>{
      const gi=routines.indexOf(r);const chk=!!rec[r.id];if(chk)done++;
      const d=document.createElement('div');d.className='row'+(chk?' done':'');
      d.innerHTML=`<div class="row-num">${p2(gi+1)}</div><div class="row-name">${r.name}</div>${r.sub?`<div class="row-sub">${r.sub}</div>`:''}<div class="row-box">${chk?'X':''}</div>`;
      d.onclick=()=>togR(r.id);blk.appendChild(d);
    });
    el.appendChild(blk);
  }
  const pct=routines.length?Math.round(done/routines.length*100):0;
  document.getElementById('dFill').style.width=pct+'%';
  document.getElementById('dPct').textContent=pct+'%';
  document.getElementById('dCnt').textContent=`${done} / ${routines.length}`;
  const ms=['Start your day.','Keep going.','Halfway done.','Almost there.','Promise kept.'];
  document.getElementById('dMsg').textContent=ms[pct===0?0:pct<30?1:pct<60?2:pct<100?3:4];
}
function togR(id){const r=getRec();r[id]=!r[id];sl('ax_d',ddata);renderR();updBot();toast(r[id]?'Checked.':'Unchecked.');}

function openAddR(){
  document.getElementById('rCatSel').innerHTML=rcats.map(c=>`<option value="${c.id}">${c.name}</option>`).join('');
  document.getElementById('rName').value='';document.getElementById('rSub').value='';
  openOv('ov-addR');
}
function doAddR(){
  const name=document.getElementById('rName').value.trim();
  if(!name){toast('Name required.',true);return;}
  routines.push({id:'r'+Date.now(),name,sub:document.getElementById('rSub').value.trim(),cat:document.getElementById('rCatSel').value});
  sl('ax_r',routines);closeOv('ov-addR');renderR();updBot();toast('Added.');
}
function openManageR(){
  const ml=document.getElementById('manRList');ml.innerHTML='';
  routines.forEach(r=>{
    const cat=rcats.find(c=>c.id===r.cat);
    const row=document.createElement('div');row.className='dl-row';
    row.innerHTML=`<div><div class="dl-name">${r.name}</div><div class="dl-sub">${cat?cat.name:'Other'}${r.sub?' · '+r.sub:''}</div></div><button class="dl-del" onclick="delR('${r.id}')">Delete</button>`;
    ml.appendChild(row);
  });
  const cl=document.getElementById('manRCat');cl.innerHTML='';
  rcats.forEach(c=>{
    const row=document.createElement('div');row.className='dl-row';
    row.innerHTML=`<div class="dl-name">${c.name}</div><button class="dl-del" onclick="delRCat('${c.id}')">Delete</button>`;
    cl.appendChild(row);
  });
  openOv('ov-manR');
}
function delR(id){routines=routines.filter(r=>r.id!==id);sl('ax_r',routines);renderR();updBot();openManageR();toast('Deleted.');}
function delRCat(id){rcats=rcats.filter(c=>c.id!==id);sl('ax_rc',rcats);renderR();openManageR();toast('Deleted.');}
function addRCat(){
  const n=document.getElementById('newRCat').value.trim();if(!n)return;
  rcats.push({id:'rc'+Date.now(),name:n});sl('ax_rc',rcats);
  document.getElementById('newRCat').value='';openManageR();
}

/* ── WORKOUTS ── */
function getWRec(){const k=vk();if(!wdata[k])wdata[k]={};return wdata[k];}
function renderW(){
  const rec=getWRec();let done=0;
  const el=document.getElementById('wList');el.innerHTML='';
  wcats.forEach(cat=>{
    const items=workouts.filter(w=>w.cat===cat.id);
    if(!items.length)return;
    const blk=document.createElement('div');blk.className='cat-block';
    blk.innerHTML=`<div class="cat-hdr"><div class="cat-name">${cat.name}</div></div>`;
    items.forEach(w=>{
      const gi=workouts.indexOf(w);const chk=!!rec[w.id];if(chk)done++;
      const d=document.createElement('div');d.className='row'+(chk?' done':'');
      d.innerHTML=`<div class="row-num">${p2(gi+1)}</div><div class="row-name">${w.name}</div><div class="row-sub">${w.weight||'-'} · ${w.reps}회 · ${w.sets}세트</div><div class="row-box">${chk?'X':''}</div>`;
      d.onclick=()=>togW(w.id);blk.appendChild(d);
    });
    el.appendChild(blk);
  });
  const uncat=workouts.filter(w=>!wcats.find(c=>c.id===w.cat));
  if(uncat.length){
    const blk=document.createElement('div');blk.className='cat-block';
    blk.innerHTML=`<div class="cat-hdr"><div class="cat-name">Other</div></div>`;
    uncat.forEach(w=>{
      const gi=workouts.indexOf(w);const chk=!!rec[w.id];if(chk)done++;
      const d=document.createElement('div');d.className='row'+(chk?' done':'');
      d.innerHTML=`<div class="row-num">${p2(gi+1)}</div><div class="row-name">${w.name}</div><div class="row-sub">${w.weight||'-'} · ${w.reps}회 · ${w.sets}세트</div><div class="row-box">${chk?'X':''}</div>`;
      d.onclick=()=>togW(w.id);blk.appendChild(d);
    });
    el.appendChild(blk);
  }
  const pct=workouts.length?Math.round(done/workouts.length*100):0;
  document.getElementById('wFill').style.width=pct+'%';
  document.getElementById('wPct').textContent=pct+'%';
  document.getElementById('wCnt').textContent=`${done} / ${workouts.length}`;
  const ms=['Start training.','Keep going.','Halfway done.','Almost there.','Session complete.'];
  document.getElementById('wMsg').textContent=ms[pct===0?0:pct<30?1:pct<60?2:pct<100?3:4];
}
function togW(id){const r=getWRec();r[id]=!r[id];sl('ax_w',wdata);renderW();toast(r[id]?'Checked.':'Unchecked.');}

function openAddW(){
  document.getElementById('wCatSel').innerHTML=wcats.map(c=>`<option value="${c.id}">${c.name}</option>`).join('');
  ['wName','wWeight','wReps','wSets'].forEach(id=>document.getElementById(id).value='');
  openOv('ov-addW');
}
function doAddW(){
  const name=document.getElementById('wName').value.trim();
  const reps=document.getElementById('wReps').value.trim();
  const sets=document.getElementById('wSets').value.trim();
  if(!name||!reps||!sets){toast('필수 항목을 입력하세요.',true);return;}
  workouts.push({id:'w'+Date.now(),name,weight:document.getElementById('wWeight').value.trim(),reps,sets,cat:document.getElementById('wCatSel').value});
  sl('ax_wo',workouts);closeOv('ov-addW');renderW();toast('Added.');
}
function openManageW(){
  const ml=document.getElementById('manWList');ml.innerHTML='';
  workouts.forEach(w=>{
    const cat=wcats.find(c=>c.id===w.cat);
    const row=document.createElement('div');row.className='dl-row';
    row.innerHTML=`<div><div class="dl-name">${w.name}</div><div class="dl-sub">${cat?cat.name:'Other'} · ${w.weight||'-'} · ${w.reps}회 · ${w.sets}세트</div></div><button class="dl-del" onclick="delW('${w.id}')">Delete</button>`;
    ml.appendChild(row);
  });
  const cl=document.getElementById('manWCat');cl.innerHTML='';
  wcats.forEach(c=>{
    const row=document.createElement('div');row.className='dl-row';
    row.innerHTML=`<div class="dl-name">${c.name}</div><button class="dl-del" onclick="delWCat('${c.id}')">Delete</button>`;
    cl.appendChild(row);
  });
  openOv('ov-manW');
}
function delW(id){workouts=workouts.filter(w=>w.id!==id);sl('ax_wo',workouts);renderW();openManageW();toast('Deleted.');}
function delWCat(id){wcats=wcats.filter(c=>c.id!==id);sl('ax_wc',wcats);renderW();openManageW();toast('Deleted.');}
function addWCat(){
  const n=document.getElementById('newWCat').value.trim();if(!n)return;
  wcats.push({id:'wc'+Date.now(),name:n});sl('ax_wc',wcats);
  document.getElementById('newWCat').value='';openManageW();
}

/* ── WORKOUT LOG ── */
function loadLog(key){
  logKey=key;
  const lg=wlog[key]||{};
  document.querySelectorAll('.chip').forEach(c=>c.classList.toggle('on',(lg.targets||[]).includes(c.dataset.v)));
  document.getElementById('wlogTime').value=lg.time||'';
  document.querySelectorAll('.rate-btn').forEach(b=>b.classList.toggle('on',b.dataset.v==lg.rating));
  document.querySelectorAll('.cond-btn').forEach(b=>b.classList.toggle('on',b.dataset.v===lg.cond));
  document.getElementById('wlogMemo').value=lg.memo||'';
  const d=new Date(key+'T00:00:00');
  const dn=['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
  document.getElementById('wlogTitle').textContent=`${d.getFullYear()}.${p2(d.getMonth()+1)}.${p2(d.getDate())} ${dn[d.getDay()]} Log`;
}
function togChip(el){el.classList.toggle('on');}
function selRate(el){document.querySelectorAll('.rate-btn').forEach(b=>b.classList.remove('on'));el.classList.add('on');}
function selCond(el){document.querySelectorAll('.cond-btn').forEach(b=>b.classList.remove('on'));el.classList.add('on');}
function saveLog(){
  wlog[logKey]={
    targets:[...document.querySelectorAll('.chip.on')].map(c=>c.dataset.v),
    time:document.getElementById('wlogTime').value,
    rating:document.querySelector('.rate-btn.on')?.dataset.v||'',
    cond:document.querySelector('.cond-btn.on')?.dataset.v||'',
    memo:document.getElementById('wlogMemo').value.trim()
  };
  sl('ax_wl',wlog);renderWCal();toast('Saved.');
}

/* ── BOTTOM BAR ── */
function updBot(){
  const rec=getRec();const done=routines.filter(r=>rec[r.id]).length;
  const pct=routines.length?Math.round(done/routines.length*100):0;
  const ms=['Start your day','Keep going','Halfway done','Almost there','Promise kept'];
  document.getElementById('botMsg').textContent=ms[pct===0?0:pct<30?1:pct<60?2:pct<100?3:4];
  document.getElementById('botCnt').textContent=`${done}/${routines.length}`;
}

/* ── PAGE & TAB ── */
function gotoPage(p){
  document.getElementById('pg-daily').style.display=p==='daily'?'block':'none';
  document.getElementById('pg-workout').style.display=p==='workout'?'block':'none';
  if(p==='workout')renderW();
}
function dTab(v,btn){
  document.querySelectorAll('#pg-daily .view').forEach(e=>e.classList.remove('on'));
  document.querySelectorAll('#pg-daily .tb').forEach(e=>e.classList.remove('on'));
  document.getElementById('vd-'+v).classList.add('on');btn.classList.add('on');
  if(v==='stats')renderDStats();
}
function wTab(v,btn){
  document.querySelectorAll('#pg-workout .view').forEach(e=>e.classList.remove('on'));
  document.querySelectorAll('#pg-workout .tb').forEach(e=>e.classList.remove('on'));
  document.getElementById('vw-'+v).classList.add('on');btn.classList.add('on');
  if(v==='cal'){renderWCal();loadLog(fmt(NOW));}
}

/* ── STATS ── */
function pClass(pct){return pct===0?'p0':pct<10?'p0':pct<30?'p10':pct<50?'p30':pct<70?'p50':pct<90?'p70':pct<100?'p90':'p100';}
function renderDStats(){
  const dim=new Date(sY,sM+1,0).getDate(),fd=new Date(sY,sM,1).getDay();
  document.getElementById('dMoLbl').textContent=['JAN','FEB','MAR','APR','MAY','JUN','JUL','AUG','SEP','OCT','NOV','DEC'][sM]+' '+sY;
  const ts=fmt(NOW),grid=document.getElementById('dCalGrid');grid.innerHTML='';
  for(let i=0;i<fd;i++){const c=document.createElement('div');c.className='cc';grid.appendChild(c);}
  for(let d=1;d<=dim;d++){
    const key=`${sY}-${p2(sM+1)}-${p2(d)}`;
    const cell=document.createElement('div');cell.textContent=d;
    if(key>ts)cell.className='cc fut';
    else if(key===ts)cell.className='cc today';
    else{const rec=ddata[key];const cnt=rec?Object.values(rec).filter(Boolean).length:0;const pct=routines.length?Math.round(cnt/routines.length*100):0;cell.className='cc '+pClass(pct);}
    grid.appendChild(cell);
  }
  let tD=0,pD=0,tC=0;const rc={};routines.forEach(r=>rc[r.id]=0);
  for(let d=1;d<=dim;d++){
    const key=`${sY}-${p2(sM+1)}-${p2(d)}`;if(key>ts)continue;tD++;
    const rec=ddata[key];if(!rec)continue;
    let cnt=0;routines.forEach(r=>{if(rec[r.id]){rc[r.id]++;cnt++;tC++;}});
    if(cnt===routines.length&&routines.length)pD++;
  }
  const avg=tD&&routines.length?Math.round(tC/(tD*routines.length)*100):0;
  document.getElementById('dStatRows').innerHTML=`<div class="stat-row"><div class="stat-lbl">Perfect Days</div><div class="stat-val">${pD} <small>days</small></div></div><div class="stat-row"><div class="stat-lbl">Avg. Rate</div><div class="stat-val">${avg} <small>%</small></div></div><div class="stat-row"><div class="stat-lbl">Total Checks</div><div class="stat-val">${tC} <small>times</small></div></div>`;
  const bars=document.getElementById('dBarRows');bars.innerHTML='';
  routines.forEach(r=>{const pct=tD?Math.round(rc[r.id]/tD*100):0;bars.innerHTML+=`<div class="bar-row"><div class="bar-nm">${r.name}</div><div class="bar-track"><div class="bar-fill" style="width:${pct}%"></div></div><div class="bar-pct">${pct}%</div></div>`;});
}
function chMo(n){sM+=n;if(sM<0){sM=11;sY--;}if(sM>11){sM=0;sY++;}renderDStats();}

function renderWCal(){
  const dim=new Date(wY,wM+1,0).getDate(),fd=new Date(wY,wM,1).getDay();
  document.getElementById('wMoLbl').textContent=['JAN','FEB','MAR','APR','MAY','JUN','JUL','AUG','SEP','OCT','NOV','DEC'][wM]+' '+wY;
  const ts=fmt(NOW),grid=document.getElementById('wCalGrid');grid.innerHTML='';
  for(let i=0;i<fd;i++){const c=document.createElement('div');c.className='cc';grid.appendChild(c);}
  let tD=0;
  for(let d=1;d<=dim;d++){
    const key=`${wY}-${p2(wM+1)}-${p2(d)}`;
    const cell=document.createElement('div');cell.textContent=d;
    if(key>ts){cell.className='cc fut';}
    else if(key===ts){cell.className='cc today';cell.onclick=()=>loadLog(key);}
    else{const rec=wdata[key];const cnt=rec?Object.values(rec).filter(Boolean).length:0;if(cnt>0){cell.className='cc trained';tD++;}else cell.className='cc p0';cell.onclick=()=>loadLog(key);}
    grid.appendChild(cell);
  }
  document.getElementById('wStatRows').innerHTML=`<div class="stat-row"><div class="stat-lbl">Trained Days</div><div class="stat-val">${tD} <small>days</small></div></div>`;
}
function chWMo(n){wM+=n;if(wM<0){wM=11;wY--;}if(wM>11){wM=0;wY++;}renderWCal();}

/* ── BACKUP ── */
function doExport(){document.getElementById('expTxt').value=JSON.stringify({ddata,wdata,wlog,routines,workouts,rcats,wcats});openOv('ov-export');}
function copyExp(){const t=document.getElementById('expTxt');t.select();document.execCommand('copy');toast('Copied.');}
function openImport(){document.getElementById('impTxt').value='';openOv('ov-import');}
function doImport(){
  try{
    const imp=JSON.parse(document.getElementById('impTxt').value.trim());
    if(imp.ddata){ddata={...ddata,...imp.ddata};sl('ax_d',ddata);}
    if(imp.wdata){wdata={...wdata,...imp.wdata};sl('ax_w',wdata);}
    if(imp.wlog){wlog={...wlog,...imp.wlog};sl('ax_wl',wlog);}
    if(imp.routines){routines=imp.routines;sl('ax_r',routines);}
    if(imp.workouts){workouts=imp.workouts;sl('ax_wo',workouts);}
    if(imp.rcats){rcats=imp.rcats;sl('ax_rc',rcats);}
    if(imp.wcats){wcats=imp.wcats;sl('ax_wc',wcats);}
    renderR();renderW();updBot();closeOv('ov-import');toast('Imported.');
  }catch{toast('Invalid data.',true);}
}
function resetD(){ddata={};sl('ax_d',ddata);renderR();updBot();toast('Reset.');}
function resetW(){wdata={};wlog={};sl('ax_w',wdata);sl('ax_wl',wlog);workouts=[];sl('ax_wo',workouts);renderW();toast('Reset.');}

/* ── MODAL ── */
function openOv(id){document.getElementById(id).classList.add('show');}
function closeOv(id){document.getElementById(id).classList.remove('show');}
document.querySelectorAll('.ov').forEach(el=>el.addEventListener('click',e=>{if(e.target===el)el.classList.remove('show');}));

/* ── TOAST ── */
let tt;
function toast(msg,err=false){const t=document.getElementById('toast');t.textContent=msg;t.className='toast show'+(err?' err':'');clearTimeout(tt);tt=setTimeout(()=>t.classList.remove('show'),1800);}

/* ── START ── */
const ok=sessionStorage.getItem('ok')==='1';
splash(()=>{if(ok)init();});
</script>

</body>
</html>
