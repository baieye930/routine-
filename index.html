<!DOCTYPE html>

<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>AXIS</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Bebas+Neue&family=IBM+Plex+Mono:wght@300;400;500&family=IBM+Plex+Sans+KR:wght@300;400;500;600&display=swap');

:root{
–bg:#f5f4f0;
–ink:#0f0f0f;
–red:#e63022;
–muted:#999999;
–border:#d8d6d0;
–surface:#ffffff;
–light:#ece9e4;
}
*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent;}
html,body{
font-family:‘IBM Plex Sans KR’,‘Apple SD Gothic Neo’,sans-serif;
background:var(–bg);color:var(–ink);
max-width:430px;margin:0 auto;min-height:100vh;overflow-x:hidden;
}
.mono{font-family:‘IBM Plex Mono’,‘Courier New’,monospace;}
.bebas{font-family:‘Bebas Neue’,‘Arial Narrow’,sans-serif;}

/* SPLASH */
#splash{position:fixed;inset:0;background:#0f0f0f;z-index:9999;display:flex;flex-direction:column;align-items:flex-start;justify-content:center;padding:60px 44px;transition:opacity .6s;}
#splash.out{opacity:0;pointer-events:none;}
.spc{position:absolute;width:18px;height:18px;border-color:#252525;border-style:solid;}
.spc.tl{top:36px;left:36px;border-width:1px 0 0 1px;}
.spc.tr{top:36px;right:36px;border-width:1px 1px 0 0;}
.spc.bl{bottom:36px;left:36px;border-width:0 0 1px 1px;}
.spc.br{bottom:36px;right:36px;border-width:0 1px 1px 0;}
.sp-top{position:absolute;top:44px;left:50%;transform:translateX(-50%);font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:8px;letter-spacing:3px;color:#2e2e2e;text-transform:uppercase;white-space:nowrap;}
.sp-welcome{font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:10px;letter-spacing:3px;color:#4a4a4a;text-transform:uppercase;margin-bottom:14px;}
.sp-title{font-family:‘Bebas Neue’,‘Arial Narrow’,sans-serif;font-size:108px;line-height:.84;letter-spacing:4px;color:#f0ede8;margin-bottom:28px;}
.sp-line{width:36px;height:2px;background:#e63022;margin-bottom:26px;}
.sp-slogan span{display:block;font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:12px;color:#f0ede8;line-height:2.3;letter-spacing:1px;}
.sp-bar-wrap{position:absolute;bottom:56px;left:44px;right:44px;}
.sp-bar-row{display:flex;justify-content:space-between;font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:8px;letter-spacing:2px;color:#2e2e2e;text-transform:uppercase;margin-bottom:7px;}
.sp-track{height:1px;background:#1c1c1c;overflow:hidden;}
.sp-fill{height:100%;background:#e63022;width:0%;transition:width .15s linear;}

/* LOCK */
#lock{position:fixed;inset:0;background:#0f0f0f;z-index:8888;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px 28px;}
#lock.gone{display:none;}
.lk-title{font-family:‘Bebas Neue’,‘Arial Narrow’,sans-serif;font-size:52px;letter-spacing:2px;color:#f0ede8;line-height:.9;text-align:center;margin-bottom:6px;}
.lk-title span{color:#e63022;}
.lk-sub{font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:9px;letter-spacing:2px;color:#555;text-transform:uppercase;margin-bottom:48px;}
.lk-dots{display:flex;gap:14px;margin-bottom:36px;}
.lk-dot{width:13px;height:13px;border-radius:50%;border:2px solid #333;transition:all .15s;}
.lk-dot.on{background:#f0ede8;border-color:#f0ede8;}
.lk-dot.err{background:#e63022;border-color:#e63022;}
.lk-err{font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:9px;letter-spacing:2px;color:#e63022;text-transform:uppercase;height:14px;margin-bottom:28px;text-align:center;}
.keypad{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;width:100%;max-width:270px;}
.k{aspect-ratio:1;background:#1a1a1a;border:none;border-radius:50%;color:#f0ede8;font-family:‘Bebas Neue’,‘Arial Narrow’,sans-serif;font-size:26px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .1s;}
.k:active{background:#2e2e2e;transform:scale(.93);}
.k.del{font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:14px;color:#555;}
.k.emp{background:transparent;pointer-events:none;}

/* APP */
#app{padding-bottom:68px;}

/* HEADER */
.hdr-block{display:flex;border-bottom:2px solid #0f0f0f;}
.hdr-main{flex:1;padding:44px 22px 18px;overflow:hidden;min-width:0;}
.hdr-eye1{font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:8px;letter-spacing:2px;color:#999;text-transform:uppercase;margin-bottom:2px;}
.hdr-eye2{font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:8px;letter-spacing:2px;color:#999;text-transform:uppercase;margin-bottom:8px;}
.hdr-title{font-family:‘Bebas Neue’,‘Arial Narrow’,sans-serif;font-size:60px;line-height:.88;letter-spacing:2px;color:#0f0f0f;}
.hdr-title span{color:#e63022;}
.hdr-quote{font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:10px;color:#999;margin-top:14px;padding-left:10px;border-left:2px solid #e63022;line-height:1.65;}

/* SIDEBAR - header only */
.hdr-sb{width:46px;flex-shrink:0;background:#0f0f0f;display:flex;flex-direction:column;align-items:center;justify-content:center;}
.sb-tab{writing-mode:vertical-rl;transform:rotate(180deg);font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:8px;letter-spacing:2px;text-transform:uppercase;color:#444;padding:16px 6px;cursor:pointer;border-left:2px solid transparent;width:100%;text-align:center;transition:all .15s;flex:1;display:flex;align-items:center;justify-content:center;}
.sb-tab.on{color:#f0ede8;border-left:2px solid #e63022;}
.sb-div{width:20px;height:1px;background:#222;}

/* DATE NAV */
.date-nav{display:flex;align-items:center;justify-content:space-between;padding:9px 22px;border-bottom:1px solid #d8d6d0;}
.dn-btn{width:26px;height:26px;background:transparent;border:1.5px solid #d8d6d0;color:#0f0f0f;font-size:15px;cursor:pointer;display:flex;align-items:center;justify-content:center;}
.dn-btn:disabled{opacity:.25;cursor:default;}
.dn-lbl{font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:10px;letter-spacing:1px;color:#0f0f0f;}
.dn-lbl.today{color:#e63022;}

/* PROGRESS */
.prog-wrap{padding:18px 22px 14px;border-bottom:1px solid #d8d6d0;}
.prog-top{display:flex;align-items:flex-end;justify-content:space-between;margin-bottom:9px;}
.prog-pct{font-family:‘Bebas Neue’,‘Arial Narrow’,sans-serif;font-size:50px;line-height:1;color:#0f0f0f;}
.prog-msg{font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:9px;color:#999;text-align:right;line-height:1.5;max-width:170px;}
.prog-track{height:2px;background:#d8d6d0;position:relative;}
.prog-fill{position:absolute;left:0;top:0;height:100%;background:#0f0f0f;transition:width .5s;}
.prog-bot{display:flex;justify-content:space-between;margin-top:5px;}
.prog-lbl{font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:8px;letter-spacing:1.5px;color:#999;text-transform:uppercase;}

/* TAB NAV */
.tab-nav{display:flex;border-bottom:2px solid #0f0f0f;}
.tb{flex:1;padding:11px 6px;border:none;border-right:1px solid #d8d6d0;background:transparent;color:#999;font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:9px;letter-spacing:2px;text-transform:uppercase;cursor:pointer;transition:all .15s;}
.tb:last-child{border-right:none;}
.tb.on{background:#0f0f0f;color:#f5f4f0;}
.view{display:none;}
.view.on{display:block;}

/* CATEGORIES */
.cat-block{border-bottom:1px solid #d8d6d0;}
.cat-hdr{padding:11px 22px 4px;}
.cat-name{font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:8px;letter-spacing:3px;text-transform:uppercase;color:#999;}
.row{display:flex;align-items:center;padding:11px 22px;border-top:1px solid #d8d6d0;cursor:pointer;user-select:none;gap:11px;transition:background .1s;}
.row:active,.row.done{background:#ece9e4;}
.row-num{font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:9px;color:#d8d6d0;width:18px;flex-shrink:0;}
.row.done .row-num{color:#e63022;}
.row-name{flex:1;font-size:14px;color:#0f0f0f;}
.row.done .row-name{text-decoration:line-through;color:#999;}
.row-sub{font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:9px;color:#999;white-space:nowrap;}
.row-box{width:17px;height:17px;border:1.5px solid #d8d6d0;display:flex;align-items:center;justify-content:center;flex-shrink:0;font-size:9px;font-family:‘IBM Plex Mono’,‘Courier New’,monospace;color:#f5f4f0;}
.row.done .row-box{background:#0f0f0f;border-color:#0f0f0f;}
.add-row{display:flex;align-items:center;padding:10px 22px;border-top:1px solid #d8d6d0;cursor:pointer;gap:11px;}
.add-row:active{background:#ece9e4;}
.add-icon{width:17px;height:17px;border:1.5px dashed #d8d6d0;display:flex;align-items:center;justify-content:center;font-size:13px;color:#d8d6d0;flex-shrink:0;}
.add-txt{font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:9px;letter-spacing:1px;text-transform:uppercase;color:#999;}

/* STATS */
.mo-nav{display:flex;align-items:center;justify-content:space-between;padding:14px 22px;border-bottom:1px solid #d8d6d0;}
.mo-lbl{font-family:‘Bebas Neue’,‘Arial Narrow’,sans-serif;font-size:26px;letter-spacing:1px;color:#0f0f0f;}
.mo-btn{width:30px;height:30px;background:transparent;border:1.5px solid #d8d6d0;color:#0f0f0f;font-size:15px;cursor:pointer;display:flex;align-items:center;justify-content:center;}
.mo-btn:active{background:#0f0f0f;color:#f5f4f0;}
.cal-wrap{padding:14px 22px;border-bottom:1px solid #d8d6d0;}
.cal-days{display:grid;grid-template-columns:repeat(7,1fr);margin-bottom:4px;}
.cal-dlbl{text-align:center;font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:8px;color:#999;padding:3px 0;}
.cal-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:2px;}
.cc{aspect-ratio:1;display:flex;align-items:center;justify-content:center;font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:10px;border-radius:2px;cursor:pointer;}
.cc.today{border:1.5px solid #e63022;color:#e63022;font-weight:700;}
.cc.p0{color:#d8d6d0;}
.cc.p10{background:#e6e6e6;color:#888;}
.cc.p30{background:#f4a261;color:#fff;}
.cc.p50{background:#e76f51;color:#fff;}
.cc.p70{background:#52b788;color:#fff;}
.cc.p90{background:#2d6a4f;color:#fff;}
.cc.p100{background:#0f0f0f;color:#f0ede8;}
.cc.fut{color:#d8d6d0;opacity:.4;cursor:default;}
.cc.trained{background:#0f0f0f;color:#f0ede8;}
.stat-row{display:flex;align-items:baseline;justify-content:space-between;padding:13px 22px;border-bottom:1px solid #d8d6d0;}
.stat-lbl{font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:9px;letter-spacing:1px;text-transform:uppercase;color:#999;}
.stat-val{font-family:‘Bebas Neue’,‘Arial Narrow’,sans-serif;font-size:30px;letter-spacing:1px;color:#0f0f0f;}
.stat-val small{font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:11px;color:#999;}
.bar-sec{padding:14px 22px;}
.bar-sec-lbl{font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:8px;letter-spacing:2px;text-transform:uppercase;color:#999;margin-bottom:12px;}
.bar-row{display:flex;align-items:center;gap:9px;margin-bottom:9px;}
.bar-nm{font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:9px;width:76px;flex-shrink:0;color:#999;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
.bar-track{flex:1;height:2px;background:#d8d6d0;position:relative;}
.bar-fill{position:absolute;left:0;top:0;height:100%;background:#0f0f0f;}
.bar-pct{font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:9px;color:#999;width:30px;text-align:right;flex-shrink:0;}

/* WORKOUT LOG */
.wlog{padding:16px 22px;border-bottom:1px solid #d8d6d0;}
.wlog-title{font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:8px;letter-spacing:3px;text-transform:uppercase;color:#999;margin-bottom:14px;}
.wf{margin-bottom:13px;}
.wf-lbl{font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:8px;letter-spacing:2px;text-transform:uppercase;color:#999;margin-bottom:6px;}
.chips{display:flex;flex-wrap:wrap;gap:5px;}
.chip{font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:10px;padding:5px 11px;border:1.5px solid #d8d6d0;cursor:pointer;transition:all .15s;color:#999;background:#f5f4f0;}
.chip.on{background:#0f0f0f;border-color:#0f0f0f;color:#f5f4f0;}
.wlog-input{width:100%;background:#fff;border:1px solid #d8d6d0;color:#0f0f0f;font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:12px;padding:10px 12px;outline:none;}
.wlog-input:focus{border-color:#0f0f0f;}
.rate-row{display:flex;gap:5px;}
.rate-btn{flex:1;padding:8px 4px;background:#f5f4f0;border:1.5px solid #d8d6d0;font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:11px;cursor:pointer;color:#999;text-align:center;}
.rate-btn.on{background:#0f0f0f;border-color:#0f0f0f;color:#f5f4f0;}
.cond-row{display:flex;gap:5px;}
.cond-btn{flex:1;padding:7px 2px;background:#f5f4f0;border:1.5px solid #d8d6d0;font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:7px;letter-spacing:.5px;cursor:pointer;color:#999;text-align:center;text-transform:uppercase;}
.cond-btn.on{background:#0f0f0f;border-color:#0f0f0f;color:#f5f4f0;}
.wlog-save{width:100%;padding:12px;background:#0f0f0f;color:#f5f4f0;border:none;font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:9px;letter-spacing:2px;text-transform:uppercase;cursor:pointer;margin-top:4px;}
.wlog-save:active{background:#e63022;}

/* SETTINGS */
.set-grp{border-bottom:1px solid #d8d6d0;}
.set-grp-lbl{padding:13px 22px 5px;font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:8px;letter-spacing:3px;text-transform:uppercase;color:#999;}
.set-row{display:flex;align-items:center;justify-content:space-between;padding:13px 22px;border-top:1px solid #d8d6d0;cursor:pointer;transition:background .1s;}
.set-row:active{background:#ece9e4;}
.set-row-name{font-size:14px;font-weight:400;color:#0f0f0f;}
.set-row-desc{font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:9px;color:#999;margin-top:2px;}
.set-row-arrow{font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:13px;color:#d8d6d0;}
.set-row.danger .set-row-name{color:#e63022;}

/* MODALS */
.ov{position:fixed;inset:0;background:rgba(0,0,0,.55);z-index:500;display:flex;align-items:flex-end;justify-content:center;opacity:0;pointer-events:none;transition:opacity .2s;}
.ov.show{opacity:1;pointer-events:all;}
.modal{background:#f5f4f0;border-top:2px solid #0f0f0f;padding:22px;width:100%;max-width:430px;transform:translateY(16px);transition:transform .25s;max-height:82vh;overflow-y:auto;}
.ov.show .modal{transform:translateY(0);}
.m-title{font-family:‘Bebas Neue’,‘Arial Narrow’,sans-serif;font-size:30px;letter-spacing:1px;margin-bottom:5px;color:#0f0f0f;}
.m-desc{font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:10px;color:#999;margin-bottom:18px;line-height:1.6;}
.m-textarea{width:100%;height:100px;background:#fff;border:1px solid #d8d6d0;color:#0f0f0f;font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:10px;padding:11px;resize:none;outline:none;margin-bottom:11px;}
.m-input{width:100%;background:#fff;border:1px solid #d8d6d0;color:#0f0f0f;font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:12px;padding:11px;outline:none;margin-bottom:9px;}
.m-input:focus{border-color:#0f0f0f;}
.m-lbl{font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:8px;letter-spacing:2px;text-transform:uppercase;color:#999;margin-bottom:5px;margin-top:3px;display:block;}
.m-sel{width:100%;background:#fff;border:1px solid #d8d6d0;color:#0f0f0f;font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:12px;padding:11px;outline:none;margin-bottom:9px;-webkit-appearance:none;}
.btn-row{display:flex;gap:7px;margin-top:4px;}
.btn{flex:1;padding:12px;border:none;font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:9px;letter-spacing:2px;text-transform:uppercase;cursor:pointer;}
.btn-p{background:#0f0f0f;color:#f5f4f0;}
.btn-p:active{background:#e63022;}
.btn-s{background:transparent;color:#0f0f0f;border:1.5px solid #d8d6d0;}
.dl-row{display:flex;align-items:center;justify-content:space-between;padding:11px 0;border-bottom:1px solid #d8d6d0;}
.dl-name{font-size:13px;color:#0f0f0f;}
.dl-sub{font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:9px;color:#999;}
.dl-del{background:none;border:1.5px solid #d8d6d0;color:#e63022;font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:9px;padding:5px 11px;cursor:pointer;letter-spacing:1px;white-space:nowrap;}
.dl-del:active{background:#e63022;color:#f5f4f0;border-color:#e63022;}
.sec-title{font-family:‘Bebas Neue’,‘Arial Narrow’,sans-serif;font-size:20px;letter-spacing:1px;margin:16px 0 8px;color:#0f0f0f;}

/* BOTTOM */
.bottom{position:fixed;bottom:0;left:50%;transform:translateX(-50%);width:100%;max-width:430px;background:#0f0f0f;color:#f5f4f0;padding:13px 22px;display:flex;justify-content:space-between;align-items:center;z-index:100;}
.bot-msg{font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:9px;letter-spacing:1.5px;text-transform:uppercase;}
.bot-cnt{font-family:‘Bebas Neue’,‘Arial Narrow’,sans-serif;font-size:22px;letter-spacing:1px;color:#e63022;}

/* TOAST */
.toast{position:fixed;bottom:66px;left:50%;transform:translateX(-50%);background:#0f0f0f;color:#f5f4f0;font-family:‘IBM Plex Mono’,‘Courier New’,monospace;font-size:9px;letter-spacing:1.5px;text-transform:uppercase;padding:9px 18px;opacity:0;transition:opacity .25s;pointer-events:none;white-space:nowrap;z-index:600;}
.toast.show{opacity:1;}
.toast.err{background:#e63022;}
</style>

</head>
<body>

<!-- SPLASH -->

<div id="splash">
  <div class="spc tl"></div><div class="spc tr"></div><div class="spc bl"></div><div class="spc br"></div>
  <div class="sp-top">Loading your data...</div>
  <div class="sp-welcome">Welcome to</div>
  <div class="sp-title">AXIS</div>
  <div class="sp-line"></div>
  <div class="sp-slogan"><span>Breathe.</span><span>Align.</span><span>Repeat.</span></div>
  <div class="sp-bar-wrap">
    <div class="sp-bar-row"><span>Initializing</span><span id="spPct">0%</span></div>
    <div class="sp-track"><div class="sp-fill" id="spFill"></div></div>
  </div>
</div>

<!-- LOCK -->

<div id="lock">
  <div class="lk-title">DAILY<br><span>ROUTINE</span></div>
  <div class="lk-sub">Enter passcode</div>
  <div class="lk-dots"><div class="lk-dot" id="d0"></div><div class="lk-dot" id="d1"></div><div class="lk-dot" id="d2"></div><div class="lk-dot" id="d3"></div></div>
  <div class="lk-err" id="lkErr"></div>
  <div class="keypad">
    <button class="k" onclick="kp('1')">1</button><button class="k" onclick="kp('2')">2</button><button class="k" onclick="kp('3')">3</button>
    <button class="k" onclick="kp('4')">4</button><button class="k" onclick="kp('5')">5</button><button class="k" onclick="kp('6')">6</button>
    <button class="k" onclick="kp('7')">7</button><button class="k" onclick="kp('8')">8</button><button class="k" onclick="kp('9')">9</button>
    <button class="k emp"></button><button class="k" onclick="kp('0')">0</button><button class="k del" onclick="kd()">DEL</button>
  </div>
</div>

<!-- APP -->

<div id="app">

  <!-- DAILY PAGE -->

  <div id="pg-daily">
    <div class="hdr-block">
      <div class="hdr-main">
        <div class="hdr-eye1">Find Your Balance with "AXIS"</div>
        <div class="hdr-eye2" id="hDate"></div>
        <div class="hdr-title">DAILY<br><span>ROUTINE</span></div>
        <div class="hdr-quote">Rejection is redirection.<br>A promise to yourself.</div>
      </div>
      <div class="hdr-sb">
        <div class="sb-tab on" onclick="gotoPage('daily')">Daily</div>
        <div class="sb-div"></div>
        <div class="sb-tab" onclick="gotoPage('workout')">Workout</div>
      </div>
    </div>
    <div class="date-nav">
      <button class="dn-btn" id="dPrev" onclick="chDay(-1)">&#8249;</button>
      <div class="dn-lbl today" id="dLbl">Today</div>
      <button class="dn-btn" id="dNext" onclick="chDay(1)" disabled>&#8250;</button>
    </div>
    <div class="prog-wrap">
      <div class="prog-top"><div class="prog-pct" id="dPct">0%</div><div class="prog-msg" id="dMsg">Start your day.</div></div>
      <div class="prog-track"><div class="prog-fill" id="dFill"></div></div>
      <div class="prog-bot"><span class="prog-lbl">Progress</span><span class="prog-lbl" id="dCnt">0 / 0</span></div>
    </div>
    <div class="tab-nav">
      <button class="tb on" onclick="dTab('today',this)">Today</button>
      <button class="tb" onclick="dTab('stats',this)">Stats</button>
      <button class="tb" onclick="dTab('settings',this)">Settings</button>
    </div>
    <div class="view on" id="vd-today">
      <div id="rList"></div>
      <div class="add-row" onclick="openAddR()"><div class="add-icon">+</div><div class="add-txt">Add item</div></div>
    </div>
    <div class="view" id="vd-stats">
      <div class="mo-nav"><button class="mo-btn" onclick="chMo(-1)">&#8249;</button><div class="mo-lbl" id="dMoLbl"></div><button class="mo-btn" onclick="chMo(1)">&#8250;</button></div>
      <div class="cal-wrap">
        <div class="cal-days"><div class="cal-dlbl">SUN</div><div class="cal-dlbl">MON</div><div class="cal-dlbl">TUE</div><div class="cal-dlbl">WED</div><div class="cal-dlbl">THU</div><div class="cal-dlbl">FRI</div><div class="cal-dlbl">SAT</div></div>
        <div class="cal-grid" id="dCal"></div>
      </div>
      <div id="dStats"></div>
      <div class="bar-sec"><div class="bar-sec-lbl">Per Item Rate</div><div id="dBars"></div></div>
    </div>
    <div class="view" id="vd-settings">
      <div class="set-grp"><div class="set-grp-lbl">Backup</div>
        <div class="set-row" onclick="doExport()"><div><div class="set-row-name">데이터 내보내기</div><div class="set-row-desc">전체 데이터 복사 보관</div></div><div class="set-row-arrow">→</div></div>
        <div class="set-row" onclick="openImport()"><div><div class="set-row-name">데이터 가져오기</div><div class="set-row-desc">복사해둔 코드 붙여넣기</div></div><div class="set-row-arrow">→</div></div>
      </div>
      <div class="set-grp"><div class="set-grp-lbl">Manage</div>
        <div class="set-row" onclick="openManR()"><div><div class="set-row-name">루틴 관리</div><div class="set-row-desc">항목 삭제 및 카테고리 수정</div></div><div class="set-row-arrow">→</div></div>
      </div>
      <div class="set-grp"><div class="set-grp-lbl">Danger</div>
        <div class="set-row danger" onclick="resetD()"><div><div class="set-row-name">전체 초기화</div><div class="set-row-desc">모든 기록 삭제</div></div><div class="set-row-arrow">→</div></div>
      </div>
    </div>
  </div>

  <!-- WORKOUT PAGE -->

  <div id="pg-workout" style="display:none;">
    <div class="hdr-block">
      <div class="hdr-main">
        <div class="hdr-eye1">Find Your Balance with "AXIS"</div>
        <div class="hdr-eye2" id="hDateW"></div>
        <div class="hdr-title">WORK<br><span>OUT</span></div>
        <div class="hdr-quote">Train hard. Track everything.<br>Show up every day.</div>
      </div>
      <div class="hdr-sb">
        <div class="sb-tab" onclick="gotoPage('daily')">Daily</div>
        <div class="sb-div"></div>
        <div class="sb-tab on" onclick="gotoPage('workout')">Workout</div>
      </div>
    </div>
    <div class="prog-wrap">
      <div class="prog-top"><div class="prog-pct" id="wPct">0%</div><div class="prog-msg" id="wMsg">Start training.</div></div>
      <div class="prog-track"><div class="prog-fill" id="wFill"></div></div>
      <div class="prog-bot"><span class="prog-lbl">Progress</span><span class="prog-lbl" id="wCnt">0 / 0</span></div>
    </div>
    <div class="tab-nav">
      <button class="tb on" onclick="wTab('today',this)">Today</button>
      <button class="tb" onclick="wTab('cal',this)">Calendar</button>
      <button class="tb" onclick="wTab('settings',this)">Settings</button>
    </div>
    <div class="view on" id="vw-today">
      <div id="wList"></div>
      <div class="add-row" onclick="openAddW()"><div class="add-icon">+</div><div class="add-txt">Add exercise</div></div>
    </div>
    <div class="view" id="vw-cal">
      <div class="mo-nav"><button class="mo-btn" onclick="chWMo(-1)">&#8249;</button><div class="mo-lbl" id="wMoLbl"></div><button class="mo-btn" onclick="chWMo(1)">&#8250;</button></div>
      <div class="cal-wrap">
        <div class="cal-days"><div class="cal-dlbl">SUN</div><div class="cal-dlbl">MON</div><div class="cal-dlbl">TUE</div><div class="cal-dlbl">WED</div><div class="cal-dlbl">THU</div><div class="cal-dlbl">FRI</div><div class="cal-dlbl">SAT</div></div>
        <div class="cal-grid" id="wCal"></div>
      </div>
      <div class="wlog">
        <div class="wlog-title" id="wlogTitle">Today's Log</div>
        <div class="wf"><div class="wf-lbl">Target 부위</div>
          <div class="chips" id="chips">
            <div class="chip" data-v="가슴" onclick="togChip(this)">가슴</div>
            <div class="chip" data-v="어깨" onclick="togChip(this)">어깨</div>
            <div class="chip" data-v="등" onclick="togChip(this)">등</div>
            <div class="chip" data-v="이두" onclick="togChip(this)">이두</div>
            <div class="chip" data-v="삼두" onclick="togChip(this)">삼두</div>
            <div class="chip" data-v="복부" onclick="togChip(this)">복부</div>
            <div class="chip" data-v="하체" onclick="togChip(this)">하체</div>
          </div>
        </div>
        <div class="wf"><div class="wf-lbl">총 운동 시간</div><input class="wlog-input" id="wlogTime" type="number" placeholder="분 (e.g. 60)"></div>
        <div class="wf"><div class="wf-lbl">만족도</div>
          <div class="rate-row">
            <button class="rate-btn" data-v="1" onclick="selRate(this)">1</button><button class="rate-btn" data-v="2" onclick="selRate(this)">2</button><button class="rate-btn" data-v="3" onclick="selRate(this)">3</button><button class="rate-btn" data-v="4" onclick="selRate(this)">4</button><button class="rate-btn" data-v="5" onclick="selRate(this)">5</button>
          </div>
        </div>
        <div class="wf"><div class="wf-lbl">컨디션</div>
          <div class="cond-row">
            <button class="cond-btn" data-v="매우좋음" onclick="selCond(this)">매우좋음</button><button class="cond-btn" data-v="좋음" onclick="selCond(this)">좋음</button><button class="cond-btn" data-v="보통" onclick="selCond(this)">보통</button><button class="cond-btn" data-v="나쁨" onclick="selCond(this)">나쁨</button>
          </div>
        </div>
        <div class="wf"><div class="wf-lbl">메모</div><input class="wlog-input" id="wlogMemo" placeholder="한 줄 메모..."></div>
        <button class="wlog-save" onclick="saveLog()">Save Log</button>
      </div>
      <div id="wStats"></div>
    </div>
    <div class="view" id="vw-settings">
      <div class="set-grp"><div class="set-grp-lbl">Backup</div>
        <div class="set-row" onclick="doExport()"><div><div class="set-row-name">데이터 내보내기</div><div class="set-row-desc">전체 데이터 복사 보관</div></div><div class="set-row-arrow">→</div></div>
        <div class="set-row" onclick="openImport()"><div><div class="set-row-name">데이터 가져오기</div><div class="set-row-desc">복사해둔 코드 붙여넣기</div></div><div class="set-row-arrow">→</div></div>
      </div>
      <div class="set-grp"><div class="set-grp-lbl">Manage</div>
        <div class="set-row" onclick="openManW()"><div><div class="set-row-name">운동 관리</div><div class="set-row-desc">항목 삭제 및 카테고리 수정</div></div><div class="set-row-arrow">→</div></div>
      </div>
      <div class="set-grp"><div class="set-grp-lbl">Danger</div>
        <div class="set-row danger" onclick="resetW()"><div><div class="set-row-name">운동 기록 초기화</div><div class="set-row-desc">모든 운동 기록 삭제</div></div><div class="set-row-arrow">→</div></div>
      </div>
    </div>
  </div>

</div>

<!-- MODALS -->

<div class="ov" id="ov-export"><div class="modal"><div class="m-title">Export</div><div class="m-desc">아래 코드를 전체 복사해서 저장하세요.</div><textarea class="m-textarea" id="expTxt" readonly></textarea><div class="btn-row"><button class="btn btn-s" onclick="closeOv('ov-export')">Close</button><button class="btn btn-p" onclick="copyExp()">Copy</button></div></div></div>
<div class="ov" id="ov-import"><div class="modal"><div class="m-title">Import</div><div class="m-desc">복사해둔 코드를 아래에 붙여넣으세요.</div><textarea class="m-textarea" id="impTxt" placeholder="Paste here..."></textarea><div class="btn-row"><button class="btn btn-s" onclick="closeOv('ov-import')">Cancel</button><button class="btn btn-p" onclick="doImport()">Import</button></div></div></div>
<div class="ov" id="ov-addR"><div class="modal"><div class="m-title">Add Item</div><label class="m-lbl">카테고리</label><select class="m-sel" id="rCatSel"></select><input class="m-input" id="rName" placeholder="Item name (e.g. 런닝)"><input class="m-input" id="rSub" placeholder="Sub label (e.g. 5 KM) — optional"><div class="btn-row"><button class="btn btn-s" onclick="closeOv('ov-addR')">Cancel</button><button class="btn btn-p" onclick="doAddR()">Add</button></div></div></div>
<div class="ov" id="ov-addW"><div class="modal"><div class="m-title">Add Exercise</div><label class="m-lbl">카테고리</label><select class="m-sel" id="wCatSel"></select><input class="m-input" id="wName" placeholder="운동 이름 (e.g. 벤치프레스)"><input class="m-input" id="wWeight" placeholder="무게 (e.g. 80kg)"><input class="m-input" id="wReps" placeholder="횟수 (e.g. 10)" type="number" min="1"><input class="m-input" id="wSets" placeholder="세트수 (e.g. 5)" type="number" min="1"><div class="btn-row"><button class="btn btn-s" onclick="closeOv('ov-addW')">Cancel</button><button class="btn btn-p" onclick="doAddW()">Add</button></div></div></div>
<div class="ov" id="ov-manR"><div class="modal"><div class="m-title">루틴 관리</div><div id="manRList"></div><div class="sec-title">카테고리 관리</div><div id="manRCat"></div><div style="display:flex;gap:7px;margin-top:9px;"><input class="m-input" id="newRCat" placeholder="새 카테고리" style="margin-bottom:0;flex:1;"><button class="btn btn-p" style="flex:0 0 auto;padding:11px 14px;" onclick="addRCat()">+</button></div><div class="btn-row" style="margin-top:14px;"><button class="btn btn-s" onclick="closeOv('ov-manR')">Close</button></div></div></div>
<div class="ov" id="ov-manW"><div class="modal"><div class="m-title">운동 관리</div><div id="manWList"></div><div class="sec-title">카테고리 관리</div><div id="manWCat"></div><div style="display:flex;gap:7px;margin-top:9px;"><input class="m-input" id="newWCat" placeholder="새 카테고리" style="margin-bottom:0;flex:1;"><button class="btn btn-p" style="flex:0 0 auto;padding:11px 14px;" onclick="addWCat()">+</button></div><div class="btn-row" style="margin-top:14px;"><button class="btn btn-s" onclick="closeOv('ov-manW')">Close</button></div></div></div>

<div class="bottom"><div class="bot-msg" id="botMsg">Start your day</div><div class="bot-cnt" id="botCnt">0/0</div></div>
<div class="toast" id="toast"></div>

<script>
const PC='4320';let pin='';
function kp(n){if(pin.length>=4)return;pin+=n;ud();if(pin.length===4){setTimeout(()=>{if(pin===PC){document.getElementById('lock').classList.add('gone');sessionStorage.setItem('ok','1');init();}else{document.querySelectorAll('.lk-dot').forEach(d=>d.classList.add('err'));document.getElementById('lkErr').textContent='Incorrect passcode';setTimeout(()=>{pin='';ud();document.querySelectorAll('.lk-dot').forEach(d=>d.classList.remove('on','err'));document.getElementById('lkErr').textContent='';},800);}},120);}}
function kd(){pin=pin.slice(0,-1);ud();}
function ud(){for(let i=0;i<4;i++)document.getElementById('d'+i).classList.toggle('on',i<pin.length);}

function splash(cb){
  const f=document.getElementById('spFill'),p=document.getElementById('spPct');let v=0;
  const iv=setInterval(()=>{v+=Math.random()*16+5;if(v>=100){v=100;f.style.width='100%';p.textContent='100%';clearInterval(iv);setTimeout(()=>{document.getElementById('splash').classList.add('out');setTimeout(cb,700);},350);}else{f.style.width=v+'%';p.textContent=Math.round(v)+'%';}},140);
}

function gl(k,d){try{const v=localStorage.getItem(k);return v?JSON.parse(v):d;}catch{return d;}}
function sl(k,v){localStorage.setItem(k,JSON.stringify(v));}

let DD=gl('ax_d',{});
let WD=gl('ax_w',{});
let WL=gl('ax_wl',{});
let RC=gl('ax_rc',[{id:'rc0',name:'Training'},{id:'rc1',name:'Nutrition'},{id:'rc2',name:'Recovery'},{id:'rc3',name:'Mind'}]);
let RR=gl('ax_r',[
  {id:'r1',name:'웨이트 트레이닝',sub:'60 MIN',cat:'rc0'},
  {id:'r2',name:'런닝',sub:'5 KM',cat:'rc0'},
  {id:'r3',name:'프로틴',sub:'48G+',cat:'rc1'},
  {id:'r4',name:'크레아틴',sub:'5G',cat:'rc1'},
  {id:'r5',name:'종합비타민',sub:'1 TAB',cat:'rc1'},
  {id:'r6',name:'수면',sub:'8 HRS',cat:'rc2'},
  {id:'r7',name:'일기 쓰기',sub:'',cat:'rc3'},
  {id:'r8',name:'글쓰기',sub:'',cat:'rc3'},
  {id:'r9',name:'독서',sub:'',cat:'rc3'},
]);
let WC=gl('ax_wc',[{id:'wc0',name:'Chest'},{id:'wc1',name:'Back'},{id:'wc2',name:'Shoulder'},{id:'wc3',name:'Arms'},{id:'wc4',name:'Legs'},{id:'wc5',name:'Core'}]);
let WW=gl('ax_wo',[]);

const NOW=new Date();
let off=0,sY=NOW.getFullYear(),sM=NOW.getMonth(),wY=NOW.getFullYear(),wM=NOW.getMonth(),lk=fmt(NOW);

function fmt(d){return`${d.getFullYear()}-${p2(d.getMonth()+1)}-${p2(d.getDate())}`}
function p2(n){return String(n).padStart(2,'0')}
function disp(d){return`${d.getFullYear()}.${p2(d.getMonth()+1)}.${p2(d.getDate())} ${'Sun,Mon,Tue,Wed,Thu,Fri,Sat'.split(',')[d.getDay()]}`}
function vd(){const d=new Date(NOW);d.setDate(d.getDate()+off);return d;}
function vk(){return fmt(vd());}

function init(){updH();renderR();renderW();updBot();}
function updH(){
  const d=vd();
  document.getElementById('hDate').textContent=disp(d);
  document.getElementById('hDateW').textContent=disp(d);
  const lb=document.getElementById('dLbl');
  lb.textContent=off===0?'Today':off===-1?'Yesterday':'2 Days Ago';
  lb.className='dn-lbl'+(off===0?' today':'');
  document.getElementById('dPrev').disabled=off<=-2;
  document.getElementById('dNext').disabled=off>=0;
}
function chDay(n){off=Math.max(-2,Math.min(0,off+n));updH();renderR();renderW();updBot();}

function getRec(){const k=vk();if(!DD[k])DD[k]={};return DD[k];}
function renderR(){
  const rec=getRec();let done=0;
  const el=document.getElementById('rList');el.innerHTML='';
  RC.forEach(cat=>{
    const items=RR.filter(r=>r.cat===cat.id);if(!items.length)return;
    const blk=document.createElement('div');blk.className='cat-block';
    blk.innerHTML=`<div class="cat-hdr"><div class="cat-name">${cat.name}</div></div>`;
    items.forEach(r=>{
      const gi=RR.indexOf(r);const chk=!!rec[r.id];if(chk)done++;
      const d=document.createElement('div');d.className='row'+(chk?' done':'');
      d.innerHTML=`<div class="row-num">${p2(gi+1)}</div><div class="row-name">${r.name}</div>${r.sub?`<div class="row-sub">${r.sub}</div>`:''}<div class="row-box">${chk?'✓':''}</div>`;
      d.onclick=()=>togR(r.id);blk.appendChild(d);
    });
    el.appendChild(blk);
  });
  const uncat=RR.filter(r=>!RC.find(c=>c.id===r.cat));
  if(uncat.length){
    const blk=document.createElement('div');blk.className='cat-block';
    blk.innerHTML=`<div class="cat-hdr"><div class="cat-name">Other</div></div>`;
    uncat.forEach(r=>{const gi=RR.indexOf(r);const chk=!!rec[r.id];if(chk)done++;const d=document.createElement('div');d.className='row'+(chk?' done':'');d.innerHTML=`<div class="row-num">${p2(gi+1)}</div><div class="row-name">${r.name}</div>${r.sub?`<div class="row-sub">${r.sub}</div>`:''}<div class="row-box">${chk?'✓':''}</div>`;d.onclick=()=>togR(r.id);blk.appendChild(d);});
    el.appendChild(blk);
  }
  const pct=RR.length?Math.round(done/RR.length*100):0;
  document.getElementById('dFill').style.width=pct+'%';
  document.getElementById('dPct').textContent=pct+'%';
  document.getElementById('dCnt').textContent=`${done} / ${RR.length}`;
  document.getElementById('dMsg').textContent=['Start your day.','Keep going.','Halfway done.','Almost there.','Promise kept.'][pct===0?0:pct<30?1:pct<60?2:pct<100?3:4];
}
function togR(id){const r=getRec();r[id]=!r[id];sl('ax_d',DD);renderR();updBot();toast(r[id]?'Checked.':'Unchecked.');}

function openAddR(){document.getElementById('rCatSel').innerHTML=RC.map(c=>`<option value="${c.id}">${c.name}</option>`).join('');document.getElementById('rName').value='';document.getElementById('rSub').value='';openOv('ov-addR');}
function doAddR(){const name=document.getElementById('rName').value.trim();if(!name){toast('Name required.',true);return;}RR.push({id:'r'+Date.now(),name,sub:document.getElementById('rSub').value.trim(),cat:document.getElementById('rCatSel').value});sl('ax_r',RR);closeOv('ov-addR');renderR();updBot();toast('Added.');}

function openManR(){
  const ml=document.getElementById('manRList');ml.innerHTML='';
  RR.forEach(r=>{const cat=RC.find(c=>c.id===r.cat);const row=document.createElement('div');row.className='dl-row';row.innerHTML=`<div><div class="dl-name">${r.name}</div><div class="dl-sub">${cat?cat.name:'Other'}${r.sub?' · '+r.sub:''}</div></div><button class="dl-del" onclick="delR('${r.id}')">Delete</button>`;ml.appendChild(row);});
  const cl=document.getElementById('manRCat');cl.innerHTML='';
  RC.forEach(c=>{const row=document.createElement('div');row.className='dl-row';row.innerHTML=`<div class="dl-name">${c.name}</div><button class="dl-del" onclick="delRC('${c.id}')">Delete</button>`;cl.appendChild(row);});
  openOv('ov-manR');
}
function delR(id){RR=RR.filter(r=>r.id!==id);sl('ax_r',RR);renderR();updBot();openManR();toast('Deleted.');}
function delRC(id){RC=RC.filter(c=>c.id!==id);sl('ax_rc',RC);renderR();openManR();toast('Deleted.');}
function addRCat(){const n=document.getElementById('newRCat').value.trim();if(!n)return;RC.push({id:'rc'+Date.now(),name:n});sl('ax_rc',RC);document.getElementById('newRCat').value='';openManR();}

function getWRec(){const k=vk();if(!WD[k])WD[k]={};return WD[k];}
function renderW(){
  const rec=getWRec();let done=0;
  const el=document.getElementById('wList');el.innerHTML='';
  WC.forEach(cat=>{
    const items=WW.filter(w=>w.cat===cat.id);if(!items.length)return;
    const blk=document.createElement('div');blk.className='cat-block';
    blk.innerHTML=`<div class="cat-hdr"><div class="cat-name">${cat.name}</div></div>`;
    items.forEach(w=>{const gi=WW.indexOf(w);const chk=!!rec[w.id];if(chk)done++;const d=document.createElement('div');d.className='row'+(chk?' done':'');d.innerHTML=`<div class="row-num">${p2(gi+1)}</div><div class="row-name">${w.name}</div><div class="row-sub">${w.weight||'-'} · ${w.reps}회 · ${w.sets}세트</div><div class="row-box">${chk?'✓':''}</div>`;d.onclick=()=>togW(w.id);blk.appendChild(d);});
    el.appendChild(blk);
  });
  const pct=WW.length?Math.round(done/WW.length*100):0;
  document.getElementById('wFill').style.width=pct+'%';
  document.getElementById('wPct').textContent=pct+'%';
  document.getElementById('wCnt').textContent=`${done} / ${WW.length}`;
  document.getElementById('wMsg').textContent=['Start training.','Keep going.','Halfway done.','Almost there.','Session complete.'][pct===0?0:pct<30?1:pct<60?2:pct<100?3:4];
}
function togW(id){const r=getWRec();r[id]=!r[id];sl('ax_w',WD);renderW();toast(r[id]?'Checked.':'Unchecked.');}

function openAddW(){document.getElementById('wCatSel').innerHTML=WC.map(c=>`<option value="${c.id}">${c.name}</option>`).join('');['wName','wWeight','wReps','wSets'].forEach(id=>document.getElementById(id).value='');openOv('ov-addW');}
function doAddW(){const name=document.getElementById('wName').value.trim();const reps=document.getElementById('wReps').value.trim();const sets=document.getElementById('wSets').value.trim();if(!name||!reps||!sets){toast('필수 항목을 입력하세요.',true);return;}WW.push({id:'w'+Date.now(),name,weight:document.getElementById('wWeight').value.trim(),reps,sets,cat:document.getElementById('wCatSel').value});sl('ax_wo',WW);closeOv('ov-addW');renderW();toast('Added.');}

function openManW(){
  const ml=document.getElementById('manWList');ml.innerHTML='';
  WW.forEach(w=>{const cat=WC.find(c=>c.id===w.cat);const row=document.createElement('div');row.className='dl-row';row.innerHTML=`<div><div class="dl-name">${w.name}</div><div class="dl-sub">${cat?cat.name:'Other'} · ${w.weight||'-'} · ${w.reps}회 · ${w.sets}세트</div></div><button class="dl-del" onclick="delW('${w.id}')">Delete</button>`;ml.appendChild(row);});
  const cl=document.getElementById('manWCat');cl.innerHTML='';
  WC.forEach(c=>{const row=document.createElement('div');row.className='dl-row';row.innerHTML=`<div class="dl-name">${c.name}</div><button class="dl-del" onclick="delWC('${c.id}')">Delete</button>`;cl.appendChild(row);});
  openOv('ov-manW');
}
function delW(id){WW=WW.filter(w=>w.id!==id);sl('ax_wo',WW);renderW();openManW();toast('Deleted.');}
function delWC(id){WC=WC.filter(c=>c.id!==id);sl('ax_wc',WC);renderW();openManW();toast('Deleted.');}
function addWCat(){const n=document.getElementById('newWCat').value.trim();if(!n)return;WC.push({id:'wc'+Date.now(),name:n});sl('ax_wc',WC);document.getElementById('newWCat').value='';openManW();}

function loadLog(key){
  lk=key;const lg=WL[key]||{};
  document.querySelectorAll('.chip').forEach(c=>c.classList.toggle('on',(lg.targets||[]).includes(c.dataset.v)));
  document.getElementById('wlogTime').value=lg.time||'';
  document.querySelectorAll('.rate-btn').forEach(b=>b.classList.toggle('on',b.dataset.v==lg.rating));
  document.querySelectorAll('.cond-btn').forEach(b=>b.classList.toggle('on',b.dataset.v===lg.cond));
  document.getElementById('wlogMemo').value=lg.memo||'';
  const d=new Date(key+'T00:00:00');
  document.getElementById('wlogTitle').textContent=`${disp(d)} Log`;
}
function togChip(el){el.classList.toggle('on');}
function selRate(el){document.querySelectorAll('.rate-btn').forEach(b=>b.classList.remove('on'));el.classList.add('on');}
function selCond(el){document.querySelectorAll('.cond-btn').forEach(b=>b.classList.remove('on'));el.classList.add('on');}
function saveLog(){
  WL[lk]={targets:[...document.querySelectorAll('.chip.on')].map(c=>c.dataset.v),time:document.getElementById('wlogTime').value,rating:document.querySelector('.rate-btn.on')?.dataset.v||'',cond:document.querySelector('.cond-btn.on')?.dataset.v||'',memo:document.getElementById('wlogMemo').value.trim()};
  sl('ax_wl',WL);renderWCal();toast('Saved.');
}

function updBot(){
  const rec=getRec();const done=RR.filter(r=>rec[r.id]).length;
  const pct=RR.length?Math.round(done/RR.length*100):0;
  document.getElementById('botMsg').textContent=['Start your day','Keep going','Halfway done','Almost there','Promise kept'][pct===0?0:pct<30?1:pct<60?2:pct<100?3:4];
  document.getElementById('botCnt').textContent=`${done}/${RR.length}`;
}

function gotoPage(p){document.getElementById('pg-daily').style.display=p==='daily'?'block':'none';document.getElementById('pg-workout').style.display=p==='workout'?'block':'none';if(p==='workout')renderW();}
function dTab(v,btn){document.querySelectorAll('#pg-daily .view').forEach(e=>e.classList.remove('on'));document.querySelectorAll('#pg-daily .tb').forEach(e=>e.classList.remove('on'));document.getElementById('vd-'+v).classList.add('on');btn.classList.add('on');if(v==='stats')renderDStats();}
function wTab(v,btn){document.querySelectorAll('#pg-workout .view').forEach(e=>e.classList.remove('on'));document.querySelectorAll('#pg-workout .tb').forEach(e=>e.classList.remove('on'));document.getElementById('vw-'+v).classList.add('on');btn.classList.add('on');if(v==='cal'){renderWCal();loadLog(fmt(NOW));}}

function pClass(p){return p===0?'p0':p<10?'p0':p<30?'p10':p<50?'p30':p<70?'p50':p<90?'p70':p<100?'p90':'p100';}
function renderDStats(){
  const dim=new Date(sY,sM+1,0).getDate(),fd=new Date(sY,sM,1).getDay();
  document.getElementById('dMoLbl').textContent='JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC'.split(',')[sM]+' '+sY;
  const ts=fmt(NOW),grid=document.getElementById('dCal');grid.innerHTML='';
  for(let i=0;i<fd;i++){const c=document.createElement('div');c.className='cc';grid.appendChild(c);}
  for(let d=1;d<=dim;d++){
    const key=`${sY}-${p2(sM+1)}-${p2(d)}`;const cell=document.createElement('div');cell.textContent=d;
    if(key>ts)cell.className='cc fut';
    else if(key===ts)cell.className='cc today';
    else{const rec=DD[key];const cnt=rec?Object.values(rec).filter(Boolean).length:0;const pct=RR.length?Math.round(cnt/RR.length*100):0;cell.className='cc '+pClass(pct);}
    grid.appendChild(cell);
  }
  let tD=0,pD=0,tC=0;const rc={};RR.forEach(r=>rc[r.id]=0);
  for(let d=1;d<=dim;d++){const key=`${sY}-${p2(sM+1)}-${p2(d)}`;if(key>ts)continue;tD++;const rec=DD[key];if(!rec)continue;let cnt=0;RR.forEach(r=>{if(rec[r.id]){rc[r.id]++;cnt++;tC++;}});if(cnt===RR.length&&RR.length)pD++;}
  const avg=tD&&RR.length?Math.round(tC/(tD*RR.length)*100):0;
  document.getElementById('dStats').innerHTML=`<div class="stat-row"><div class="stat-lbl">Perfect Days</div><div class="stat-val">${pD} <small>days</small></div></div><div class="stat-row"><div class="stat-lbl">Avg. Rate</div><div class="stat-val">${avg} <small>%</small></div></div><div class="stat-row"><div class="stat-lbl">Total Checks</div><div class="stat-val">${tC} <small>times</small></div></div>`;
  const bars=document.getElementById('dBars');bars.innerHTML='';
  RR.forEach(r=>{const pct=tD?Math.round(rc[r.id]/tD*100):0;bars.innerHTML+=`<div class="bar-row"><div class="bar-nm">${r.name}</div><div class="bar-track"><div class="bar-fill" style="width:${pct}%"></div></div><div class="bar-pct">${pct}%</div></div>`;});
}
function chMo(n){sM+=n;if(sM<0){sM=11;sY--;}if(sM>11){sM=0;sY++;}renderDStats();}

function renderWCal(){
  const dim=new Date(wY,wM+1,0).getDate(),fd=new Date(wY,wM,1).getDay();
  document.getElementById('wMoLbl').textContent='JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC'.split(',')[wM]+' '+wY;
  const ts=fmt(NOW),grid=document.getElementById('wCal');grid.innerHTML='';
  for(let i=0;i<fd;i++){const c=document.createElement('div');c.className='cc';grid.appendChild(c);}
  let tD=0;
  for(let d=1;d<=dim;d++){
    const key=`${wY}-${p2(wM+1)}-${p2(d)}`;const cell=document.createElement('div');cell.textContent=d;
    if(key>ts)cell.className='cc fut';
    else if(key===ts){cell.className='cc today';cell.onclick=()=>loadLog(key);}
    else{const rec=WD[key];const cnt=rec?Object.values(rec).filter(Boolean).length:0;if(cnt>0){cell.className='cc trained';tD++;}else cell.className='cc p0';cell.onclick=()=>loadLog(key);}
    grid.appendChild(cell);
  }
  document.getElementById('wStats').innerHTML=`<div class="stat-row"><div class="stat-lbl">Trained Days</div><div class="stat-val">${tD} <small>days</small></div></div>`;
}
function chWMo(n){wM+=n;if(wM<0){wM=11;wY--;}if(wM>11){wM=0;wY++;}renderWCal();}

function doExport(){document.getElementById('expTxt').value=JSON.stringify({DD,WD,WL,RR,WW,RC,WC});openOv('ov-export');}
function copyExp(){const t=document.getElementById('expTxt');t.select();document.execCommand('copy');toast('Copied.');}
function openImport(){document.getElementById('impTxt').value='';openOv('ov-import');}
function doImport(){
  try{
    const imp=JSON.parse(document.getElementById('impTxt').value.trim());
    if(imp.DD){DD={...DD,...imp.DD};sl('ax_d',DD);}if(imp.WD){WD={...WD,...imp.WD};sl('ax_w',WD);}if(imp.WL){WL={...WL,...imp.WL};sl('ax_wl',WL);}
    if(imp.RR){RR=imp.RR;sl('ax_r',RR);}if(imp.WW){WW=imp.WW;sl('ax_wo',WW);}if(imp.RC){RC=imp.RC;sl('ax_rc',RC);}if(imp.WC){WC=imp.WC;sl('ax_wc',WC);}
    renderR();renderW();updBot();closeOv('ov-import');toast('Imported.');
  }catch{toast('Invalid data.',true);}
}
function resetD(){DD={};sl('ax_d',DD);renderR();updBot();toast('Reset.');}
function resetW(){WD={};WL={};sl('ax_w',WD);sl('ax_wl',WL);WW=[];sl('ax_wo',WW);renderW();toast('Reset.');}

function openOv(id){document.getElementById(id).classList.add('show');}
function closeOv(id){document.getElementById(id).classList.remove('show');}
document.querySelectorAll('.ov').forEach(el=>el.addEventListener('click',e=>{if(e.target===el)el.classList.remove('show');}));

let tt;
function toast(msg,err=false){const t=document.getElementById('toast');t.textContent=msg;t.className='toast show'+(err?' err':'');clearTimeout(tt);tt=setTimeout(()=>t.classList.remove('show'),1800);}

splash(()=>{if(sessionStorage.getItem('ok')==='1')init();});
</script>

</body>
</html>
